import{r as x,j as e}from"./app-BytpB0TX.js";import{U as P}from"./user-DeoVP0od.js";import{X as E}from"./x-DJBYx-Hm.js";import{C as O}from"./circle-x-CRU1fK1E.js";import{S as q}from"./star-CWY1vcCR.js";import{M as A}from"./message-circle-DqAezM8H.js";import"./createLucideIcon-C9b6KVSr.js";const D={professionalism:{5:"Excellent",4:"Good",3:"Average",2:"Poor",1:"Very Poor"},communication:{5:"Excellent",4:"Good",3:"Average",2:"Poor",1:"Very Poor"},treatment_quality:{5:"Excellent",4:"Good",3:"Average",2:"Poor",1:"Very Poor"},bedside_manner:{5:"Excellent",4:"Good",3:"Average",2:"Poor",1:"Very Poor"}};function F({isOpen:w,onClose:b,doctor:r,clinic:p,onReviewSubmitted:y}){const[m,g]=x.useState(0),[u,h]=x.useState({professionalism:0,communication:0,treatment_quality:0,bedside_manner:0}),[a,d]=x.useState({rating:0,title:"",content:"",staff_id:(r==null?void 0:r.id)||null,professionalism_rating:0,communication_rating:0,treatment_quality_rating:0,bedside_manner_rating:0,comment:""}),[j,v]=x.useState(!1),[l,n]=x.useState({}),_=t=>{g(t),d(i=>({...i,rating:t}))},S=(t,i)=>{h(s=>({...s,[t]:i})),d(s=>({...s,[`${t}_rating`]:i}))},f=(t,i)=>{d(s=>({...s,[t]:i}))},C=async t=>{var i;if(t.preventDefault(),n({}),m===0){n({rating:"Please provide an overall rating."});return}if(Object.values(u).some(s=>s===0)){n({categories:"Please rate all categories."});return}if(!a.content||a.content.length<10){n({content:"Please provide a review content (minimum 10 characters)."});return}v(!0);try{const s={rating:a.rating,title:a.title,content:a.content,staff_id:a.staff_id,professionalism_rating:a.professionalism_rating,communication_rating:a.communication_rating,treatment_quality_rating:a.treatment_quality_rating,bedside_manner_rating:a.bedside_manner_rating,comment:a.comment};console.log("Submitting doctor review with data:",s),console.log("Clinic ID:",p.id),console.log("Doctor ID:",r.id);const o=await fetch(`/clinics/${p.id}/reviews`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":(i=document.querySelector('meta[name="csrf-token"]'))==null?void 0:i.getAttribute("content"),Accept:"application/json"},body:JSON.stringify(s)});console.log("Response status:",o.status),console.log("Response headers:",o.headers);const c=await o.json();if(console.log("Response data:",c),!o.ok){if(o.status===422&&c.errors){const k=Object.values(c.errors).flat();n({general:k[0]||"Please check your input and try again."});return}if(o.status===400&&c.message){n({general:c.message});return}c.message?n({general:c.message}):n({general:"Failed to submit review. Please try again."});return}const R=c.review;y&&y(R),d({rating:0,title:"",content:"",staff_id:(r==null?void 0:r.id)||null,professionalism_rating:0,communication_rating:0,treatment_quality_rating:0,bedside_manner_rating:0,comment:""}),g(0),h({professionalism:0,communication:0,treatment_quality:0,bedside_manner:0}),b()}catch(s){console.error("Error submitting doctor review:",s),console.error("Error details:",{message:s.message,name:s.name,stack:s.stack}),s.name==="TypeError"&&s.message.includes("fetch")?n({general:"Network error. Please check your connection and try again."}):s.name==="SyntaxError"?n({general:"Server error. Please try again later."}):n({general:"An unexpected error occurred. Please try again."})}finally{v(!1)}},N=()=>{d({rating:0,title:"",content:"",staff_id:(r==null?void 0:r.id)||null,professionalism_rating:0,communication_rating:0,treatment_quality_rating:0,bedside_manner_rating:0,comment:""}),g(0),h({professionalism:0,communication:0,treatment_quality:0,bedside_manner:0}),b()};return!w||!r?null:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center",children:e.jsx(P,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Review Dr. ",r.name]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Share your experience with this doctor"})]})]}),e.jsx("button",{onClick:N,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(E,{className:"w-5 h-5 text-gray-500"})})]}),e.jsxs("form",{onSubmit:C,className:"p-6 space-y-6",children:[l.general&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(O,{className:"w-5 h-5 text-red-400"})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-800",children:l.general})})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Overall Rating *"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[[1,2,3,4,5].map(t=>e.jsx("button",{type:"button",onClick:()=>_(t),className:`p-1 transition-colors ${t<=m?"text-yellow-400":"text-gray-300 hover:text-yellow-300"}`,children:e.jsx(q,{className:"w-8 h-8 fill-current"})},t)),e.jsx("span",{className:"ml-3 text-sm text-gray-600",children:m>0&&`${m}/5 stars`})]}),l.rating&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l.rating})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Rate your experience in each category *"}),e.jsx("div",{className:"space-y-4",children:Object.entries(D).map(([t,i])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex-1",children:e.jsx("label",{className:"block text-sm font-medium text-gray-700 capitalize",children:t.replace("_"," ")})}),e.jsx("div",{className:"flex-1 max-w-xs",children:e.jsxs("select",{value:u[t],onChange:s=>S(t,parseInt(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[e.jsx("option",{value:0,children:"Select rating"}),Object.entries(i).map(([s,o])=>e.jsxs("option",{value:s,children:[s," - ",o]},s))]})})]},t))}),l.categories&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:l.categories})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Review Title"}),e.jsx("input",{type:"text",value:a.title,onChange:t=>f("title",t.target.value),placeholder:"Brief title for your review (optional)",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Your Review *"}),e.jsx("textarea",{value:a.content,onChange:t=>f("content",t.target.value),placeholder:"Share your experience with this doctor (minimum 10 characters)",rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"}),e.jsxs("div",{className:"flex justify-between items-center mt-1",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[a.content.length,"/1000 characters"]}),a.content.length<10&&a.content.length>0&&e.jsx("span",{className:"text-xs text-red-500",children:"Minimum 10 characters required"})]}),l.content&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l.content})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Additional Comments (Optional)"}),e.jsx("textarea",{value:a.comment,onChange:t=>f("comment",t.target.value),placeholder:"Any additional thoughts or suggestions (optional)",rows:2,maxLength:200,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"}),e.jsx("div",{className:"flex justify-between items-center mt-1",children:e.jsxs("span",{className:"text-xs text-gray-500",children:[a.comment.length,"/200 characters"]})})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:N,className:"px-6 py-3 text-gray-600 hover:text-gray-800 font-medium transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:j||m===0||Object.values(u).some(t=>t===0)||!a.content||a.content.length<10,className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-semibold rounded-lg hover:from-blue-700 hover:to-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center space-x-2",children:[e.jsx(A,{className:"w-4 h-4"}),e.jsx("span",{children:j?"Submitting...":"Submit Review"})]})]})]})]})})}export{F as default};
