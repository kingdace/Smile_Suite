import{r as o,v as $e,j as e,$ as Fe,m as T}from"./app-BWxQYrX6.js";import{A as Oe,f as Ee,D as le,b as re,c as ie,d as ne,e as de}from"./AuthenticatedLayout-qAPAn_x5.js";import{B as d}from"./button-CPcSBPFh.js";import{C as y,a as F,b as O,c as b}from"./card-CsaC10C3.js";import{I as A}from"./input--euKJla3.js";import{L as m}from"./label-BqJOMct_.js";import{S as ce,a as oe,b as me,c as he,d as xe}from"./select-BXZOfes3.js";import{S as W}from"./switch-BtyX6lOp.js";import{T as Me,a as Ue,b as ue,c as pe}from"./tabs-B9yxDIRW.js";import{B as qe}from"./badge-D2HCse-l.js";import{t as r}from"./index-6Q4yuks5.js";import{S as D}from"./settings-JFdQf705.js";import{P as J}from"./plus-DZ4KkTSa.js";import{U as g}from"./user-oEMFmpBd.js";import{C as E}from"./calendar-D24UCPWo.js";import{C as K}from"./circle-check-big-3-_3u0jr.js";import{T as Be}from"./triangle-alert-OBXn1-EQ.js";import{C as Re}from"./copy-uVguuE-0.js";import{C as ge}from"./clock-Dg12Dfp2.js";import{S as Le}from"./square-pen-CtBlYgPf.js";import{T as Xe}from"./trash-2-DEAVWFvp.js";import{C as He}from"./circle-x-Dfm_zbyn.js";import"./index-BGZbWSET.js";import"./layout-dashboard-B7xWly84.js";import"./createLucideIcon-C-SF-e7E.js";import"./users-D28d9V-z.js";import"./stethoscope-BePhj6bx.js";import"./scissors-Dqps4-NJ.js";import"./dollar-sign-JaFWOl8x.js";import"./chevron-right-B6CR-LxY.js";import"./shield-Du_-C_3t.js";import"./trending-up-CcwnyvAK.js";import"./circle-alert-C9uAGIcv.js";import"./loader-circle-C0rYjyGN.js";import"./SiteHeader-BIRnvd5N.js";import"./index-C8s1n2oo.js";import"./x-D5TWC7ZM.js";import"./crown-C_VyokGJ.js";import"./zap-B57EPhTQ.js";import"./info-yq3WN-vu.js";import"./building-2-BAoYD3sH.js";import"./file-text-CdUJ8PC7.js";import"./index-CmIe2631.js";import"./index-BPDCYA0y.js";import"./index-C0CE8RNb.js";const z=[{value:1,label:"Monday"},{value:2,label:"Tuesday"},{value:3,label:"Wednesday"},{value:4,label:"Thursday"},{value:5,label:"Friday"},{value:6,label:"Saturday"},{value:0,label:"Sunday"}],fe=[{id:"standard_week",name:"Standard Week (Mon-Fri)",description:"9 AM - 5 PM, Monday to Friday",schedule:[{day:1,start:"09:00",end:"17:00"},{day:2,start:"09:00",end:"17:00"},{day:3,start:"09:00",end:"17:00"},{day:4,start:"09:00",end:"17:00"},{day:5,start:"09:00",end:"17:00"}]},{id:"extended_hours",name:"Extended Hours (Mon-Sat)",description:"8 AM - 6 PM, Monday to Saturday",schedule:[{day:1,start:"08:00",end:"18:00"},{day:2,start:"08:00",end:"18:00"},{day:3,start:"08:00",end:"18:00"},{day:4,start:"08:00",end:"18:00"},{day:5,start:"08:00",end:"18:00"},{day:6,start:"09:00",end:"14:00"}]}];function Bs({auth:je,clinic:v,schedules:ye,dentists:N}){var ee,se,te,ae;const[i,be]=o.useState(null),[ve,p]=o.useState(!1),[u,_]=o.useState(null),[w,S]=o.useState(null),[We,Q]=o.useState(!1),[Je,Ke]=o.useState(null),[B,k]=o.useState(!1),[R,P]=o.useState(!1),[ze,M]=o.useState(null),[U,Y]=o.useState("list"),[Ne,C]=o.useState(!1),[n,_e]=o.useState(null),[f,L]=o.useState(!1),[h,I]=o.useState([]),[G,X]=o.useState(!1),{data:a,setData:x,processing:H,reset:j}=$e({user_id:"",day_of_week:"",start_time:"",end_time:"",buffer_time:15,slot_duration:30,is_available:!0,schedule_type:"weekly",notes:"",allow_overlap:!1,max_appointments_per_day:null}),V=i?ye[i]||[]:[],we=s=>{be(s);const t=N.find(l=>l.id.toString()===s);t&&(r.success(`Viewing schedules for ${t.name}`),Se(s))},Se=async s=>{Q(!0);try{const l=await(await fetch(route("clinic.dentist-schedules.unified-info",{clinic:v.id,dentist_id:s}))).json();l.success&&_e(l.info)}catch(t){console.error("Error loading unified schedule info:",t)}finally{Q(!1)}},Ce=async()=>{if(i)try{const t=await(await fetch(route("clinic.dentist-schedules.sync-profile",{clinic:v.id}),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({dentist_id:i})})).json();t.success?(r.success(t.message),T.reload({only:["schedules"]})):r.error(t.message||"Failed to sync profile to schedule")}catch(s){console.error("Error syncing profile to schedule:",s),r.error("Failed to sync profile to schedule")}},ke=s=>{if(!i){r.error("Please select a dentist first before applying a template");return}S(s),C(!0)},Te=()=>{if(!w){r.error("Please select a template first");return}if(!i){r.error("Please select a dentist first");return}const s={template_key:w.id,dentist_ids:[parseInt(i)]};X(!0),fetch(route("clinic.dentist-schedules.create-from-template",{clinic:v.id}),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify(s)}).then(t=>t.json()).then(t=>{t.success?(r.success(t.message||`Applied ${w.name} template successfully`),C(!1),S(null),T.reload({only:["schedules"]})):r.error(t.message||"Failed to apply template"),X(!1)}).catch(t=>{console.error("Template application error:",t),r.error("Failed to apply template. Please try again."),X(!1)})},Ae=()=>{if(console.log("ðŸš€ handleSubmit called!"),console.log("Current state:",{isQuickSetup:f,selectedDays:h,editingSchedule:u,isCreating:B,isUpdating:R,processing:H,data:a}),!a.user_id){r.error("Please select a dentist");return}if(f&&!u){if(h.length===0){r.error("Please select at least one day");return}}else if(!a.day_of_week&&a.day_of_week!==0){r.error("Please select a day of the week");return}if(!a.start_time||!a.end_time){r.error("Please set both start and end times");return}if(a.start_time>=a.end_time){r.error("End time must be after start time");return}if(u){if(P(!0),!a.start_time||!a.end_time){r.error("Please set both start and end times"),P(!1);return}const s={day_of_week:parseInt(a.day_of_week),start_time:a.start_time,end_time:a.end_time,buffer_time:parseInt(a.buffer_time)||15,slot_duration:parseInt(a.slot_duration)||30,is_available:!!a.is_available,schedule_type:a.schedule_type||"weekly",notes:a.notes||"",allow_overlap:!!a.allow_overlap,max_appointments_per_day:a.max_appointments_per_day?parseInt(a.max_appointments_per_day):null};console.log("Update data being sent:",s),fetch(route("clinic.dentist-schedules.update",{clinic:v.id,schedule:u.id}),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({...s,_method:"PUT"})}).then(t=>t.ok?t.json():t.json().then(l=>{throw new Error(JSON.stringify(l))})).then(t=>{t.success?(r.success(t.message||"Schedule updated successfully"),j(),_(null),p(!1),P(!1),T.reload({only:["schedules"]})):(r.error(t.message||"Failed to update schedule"),P(!1))}).catch(t=>{console.error("Update error:",t);try{const l=JSON.parse(t.message);l.errors?Object.values(l.errors).flat().forEach(c=>{r.error(c)}):r.error(l.message||"Failed to update schedule")}catch{r.error("Failed to update schedule. Please try again.")}P(!1)})}else if(k(!0),f&&h.length>0){console.log("Starting Quick Setup for days:",h),console.log("Base data:",a);const s=h.map(t=>{const l={...a,user_id:parseInt(a.user_id),day_of_week:parseInt(t),buffer_time:parseInt(a.buffer_time)||15,slot_duration:parseInt(a.slot_duration)||30,is_available:!!a.is_available,allow_overlap:!!a.allow_overlap,max_appointments_per_day:a.max_appointments_per_day?parseInt(a.max_appointments_per_day):null};return console.log(`Creating schedule for day ${t}:`,l),fetch(route("clinic.dentist-schedules.store",{clinic:v.id}),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(l)}).then(c=>(console.log(`Response for day ${t}:`,c.status),c.json())).catch(c=>(console.error(`Error for day ${t}:`,c),{success:!1,message:`Failed to create schedule for day ${t}`}))});console.log("All promises created, waiting for results..."),Promise.all(s).then(t=>{console.log("All results received:",t);const l=t.filter($=>$.success),c=t.filter($=>!$.success);console.log(`Successful: ${l.length}, Failed: ${c.length}`),l.length>0&&r.success(`Successfully created ${l.length} schedule(s)`),c.length>0&&c.forEach($=>{r.error($.message||"Failed to create schedule")}),l.length>0&&(j(),p(!1),I([]),L(!1),T.reload({only:["schedules"]})),k(!1)}).catch(t=>{console.error("Bulk create error:",t),r.error("Failed to create schedules. Please try again."),k(!1)})}else{const s=route("clinic.dentist-schedules.store",{clinic:v.id}),t={...a,user_id:parseInt(a.user_id),day_of_week:parseInt(a.day_of_week),buffer_time:parseInt(a.buffer_time)||15,slot_duration:parseInt(a.slot_duration)||30,is_available:!!a.is_available,allow_overlap:!!a.allow_overlap,max_appointments_per_day:a.max_appointments_per_day?parseInt(a.max_appointments_per_day):null};fetch(s,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify(t)}).then(l=>l.json()).then(l=>{l.success?(r.success(l.message||"Schedule created successfully"),j(),p(!1),k(!1),T.reload({only:["schedules"]})):(r.error(l.message||"Failed to create schedule"),k(!1))}).catch(l=>{console.error("Create error:",l),r.error("Failed to create schedule. Please try again."),k(!1)})}},De=s=>{var c;console.log("Schedule data for editing:",s),_(s);const t=s.start_time?s.start_time.includes("T")?s.start_time.split("T")[1].substring(0,5):s.start_time.substring(0,5):"",l=s.end_time?s.end_time.includes("T")?s.end_time.split("T")[1].substring(0,5):s.end_time.substring(0,5):"";console.log("Formatted times:",{startTime:t,endTime:l}),x({user_id:s.user_id.toString(),day_of_week:((c=s.day_of_week)==null?void 0:c.toString())||"",start_time:t,end_time:l,buffer_time:s.buffer_time||15,slot_duration:s.slot_duration||30,is_available:s.is_available,schedule_type:s.schedule_type||"weekly",notes:s.notes||"",allow_overlap:s.allow_overlap||!1,max_appointments_per_day:s.max_appointments_per_day||null}),p(!0)},Pe=s=>{confirm("Are you sure you want to delete this schedule? This action cannot be undone.")&&(M(s.id),fetch(route("clinic.dentist-schedules.destroy",{clinic:v.id,schedule:s.id}),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({_method:"DELETE"})}).then(t=>t.json()).then(t=>{t.success?(r.success(t.message||"Schedule deleted successfully"),M(null),T.reload({only:["schedules"]})):(r.error(t.message||"Failed to delete schedule"),M(null))}).catch(t=>{console.error("Delete error:",t),r.error("Failed to delete schedule. Please try again."),M(null)}))},q=s=>{const t=parseInt(s),l=z.find(c=>c.value===t);return(l==null?void 0:l.label)||"Unknown"},Z=s=>s.includes("T")?s.split("T")[1].substring(0,5):s.substring(0,5),Ie=s=>s?e.jsx(K,{className:"h-4 w-4 text-green-500"}):e.jsx(He,{className:"h-4 w-4 text-red-500"});return e.jsxs(Oe,{auth:je,children:[e.jsx(Fe,{title:"Dentist Schedule Management"}),e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-100 via-blue-150 to-cyan-100 rounded-t-lg mx-0 pt-4 shadow-2xl border border-blue-200/50 border-t border-t-blue-200",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-indigo-600 to-purple-600 rounded-full shadow-lg",children:e.jsx(Ee,{className:"h-8 w-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900",children:"Dentist Schedule Management"}),e.jsx("p",{className:"text-gray-600 mt-2 text-lg",children:"Manage dentist availability and time slots"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(d,{onClick:()=>{S(null),C(!0)},variant:"outline",className:"px-6 py-3 bg-white border-2 border-indigo-200 text-indigo-600 hover:bg-indigo-50 hover:border-indigo-300 shadow-sm",children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Templates"]}),e.jsxs(d,{onClick:()=>{console.log("ðŸ†• Add Schedule button clicked - clearing editingSchedule"),_(null),j(),p(!0)},className:"px-6 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(J,{className:"h-5 w-5 mr-2"}),"Add Schedule"]})]})]})}),e.jsxs(y,{className:"mb-8 border-0 shadow-lg bg-white/80 backdrop-blur-sm",children:[e.jsx(F,{className:"bg-gradient-to-r from-indigo-50 to-purple-50 border-b",children:e.jsxs(O,{className:"flex items-center gap-3 text-xl",children:[e.jsx(g,{className:"h-6 w-6 text-indigo-600"}),"Select Dentist"]})}),e.jsx(b,{className:"p-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4",children:N.map(s=>e.jsxs(d,{variant:i===s.id.toString()?"default":"outline",onClick:()=>we(s.id.toString()),className:`flex flex-col items-center gap-3 h-auto py-6 px-4 transition-all duration-300 ${i===s.id.toString()?"bg-gradient-to-r from-indigo-600 to-purple-600 text-white shadow-lg transform scale-105":"bg-white border-2 border-gray-200 hover:border-indigo-300 hover:shadow-md hover:bg-indigo-50"}`,children:[e.jsx("div",{className:`p-3 rounded-full ${i===s.id.toString()?"bg-white/20":"bg-indigo-100"}`,children:e.jsx(g,{className:`h-5 w-5 ${i===s.id.toString()?"text-white":"text-indigo-600"}`})}),e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"font-semibold text-sm",children:s.name}),e.jsx("p",{className:`text-xs mt-1 ${i===s.id.toString()?"text-white/80":"text-gray-500"}`,children:s.email})]})]},s.id))})})]}),i&&n&&e.jsxs(y,{className:"mb-6 border-0 shadow-lg bg-gradient-to-r from-blue-50 to-indigo-50",children:[e.jsx(F,{children:e.jsxs(O,{className:"flex items-center gap-3 text-lg",children:[e.jsx(D,{className:"h-5 w-5 text-blue-600"}),"Schedule System Information"]})}),e.jsxs(b,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white rounded-lg shadow-sm",children:[e.jsx("div",{className:`p-2 rounded-full ${n.has_advanced_schedules?"bg-green-100":"bg-yellow-100"}`,children:e.jsx(E,{className:`h-4 w-4 ${n.has_advanced_schedules?"text-green-600":"text-yellow-600"}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Advanced Schedules"}),e.jsx("p",{className:`text-xs ${n.has_advanced_schedules?"text-green-600":"text-yellow-600"}`,children:n.has_advanced_schedules?"Active":"Not configured"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white rounded-lg shadow-sm",children:[e.jsx("div",{className:`p-2 rounded-full ${n.has_profile_hours?"bg-blue-100":"bg-gray-100"}`,children:e.jsx(g,{className:`h-4 w-4 ${n.has_profile_hours?"text-blue-600":"text-gray-400"}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Profile Hours"}),e.jsx("p",{className:`text-xs ${n.has_profile_hours?"text-blue-600":"text-gray-500"}`,children:n.has_profile_hours?"Configured":"Not set"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white rounded-lg shadow-sm",children:[e.jsx("div",{className:`p-2 rounded-full ${n.is_active?"bg-green-100":"bg-red-100"}`,children:e.jsx(K,{className:`h-4 w-4 ${n.is_active?"text-green-600":"text-red-600"}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Account Status"}),e.jsx("p",{className:`text-xs ${n.is_active?"text-green-600":"text-red-600"}`,children:n.is_active?"Active":"Inactive"})]})]})]}),n.has_profile_hours&&!n.has_advanced_schedules&&e.jsx("div",{className:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Be,{className:"h-5 w-5 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-yellow-800",children:"Profile Hours Available"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"This dentist has working hours set in their profile but no advanced schedules configured."})]})]}),e.jsxs(d,{onClick:Ce,className:"bg-yellow-600 hover:bg-yellow-700 text-white",size:"sm",children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),"Sync to Advanced Schedule"]})]})}),e.jsx("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Current Schedule Source:"})," ",n.schedule_source==="advanced"?"Advanced Schedule Management":"Profile Working Hours"]})})]})]}),e.jsxs(Me,{children:[e.jsxs(Ue,{className:"grid w-full grid-cols-2",children:[e.jsx(ue,{active:U==="list",onClick:()=>Y("list"),children:"List View"}),e.jsx(ue,{active:U==="templates",onClick:()=>Y("templates"),children:"Templates"})]}),U==="list"&&e.jsx(pe,{className:"space-y-4",children:i?e.jsxs("div",{className:"space-y-6",children:[e.jsxs(y,{className:"border-0 shadow-lg",children:[e.jsx(F,{className:"bg-gradient-to-r from-indigo-50 to-purple-50 border-b",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(O,{className:"flex items-center gap-3 text-xl",children:[e.jsx(E,{className:"h-6 w-6 text-indigo-600"}),"Advanced Schedules for"," ",e.jsx("span",{className:"text-indigo-600",children:(ee=N.find(s=>s.id.toString()===i))==null?void 0:ee.name})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(d,{onClick:()=>{console.log("ðŸ†• Add Schedule button clicked (dentist view) - clearing editingSchedule"),_(null),j(),p(!0)},className:"bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Add Schedule"]})})]})}),e.jsx(b,{className:"p-6",children:V.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"p-4 bg-gray-100 rounded-full w-20 h-20 mx-auto mb-4 flex items-center justify-center",children:e.jsx(ge,{className:"h-8 w-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"No Advanced Schedules"}),e.jsx("p",{className:"text-gray-500 mb-6 max-w-md mx-auto",children:"This dentist doesn't have any advanced schedules configured yet. You can add schedules manually or sync from their profile."}),e.jsx("div",{className:"flex items-center justify-center gap-3",children:e.jsxs(d,{onClick:()=>{console.log("ðŸ†• Add Schedule button clicked (empty state) - clearing editingSchedule"),_(null),j(),p(!0)},className:"bg-indigo-600 hover:bg-indigo-700 text-white",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Add Schedule"]})})]}):e.jsxs("div",{className:"space-y-4",children:[(n==null?void 0:n.schedule_source)==="advanced"&&e.jsx("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm text-green-700 font-medium",children:"Using Advanced Schedule Management"})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:V.map(s=>e.jsxs("div",{className:`p-4 rounded-lg border-2 transition-all duration-300 hover:shadow-md ${s.is_available?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[Ie(s.is_available),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:q(s.day_of_week)}),e.jsx("p",{className:"text-sm text-gray-600",children:s.schedule_type==="weekly"?"Weekly Schedule":"Exception"})]})]}),e.jsx(qe,{variant:s.is_available?"default":"secondary",className:s.is_available?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:s.is_available?"Available":"Unavailable"})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ge,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"font-medium text-gray-700",children:[Z(s.start_time)," ","-"," ",Z(s.end_time)]})]}),s.buffer_time&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(D,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-gray-600",children:["Buffer:"," ",s.buffer_time," ","min"]})]}),s.slot_duration&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(E,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-gray-600",children:["Slot Duration:"," ",s.slot_duration," ","min"]})]}),s.notes&&e.jsxs("div",{className:"text-sm text-gray-600 bg-white p-2 rounded border",children:[e.jsx("strong",{children:"Notes:"})," ",s.notes]})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-3 border-t border-gray-200",children:[e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>De(s),className:"flex-1",children:[e.jsx(Le,{className:"h-4 w-4 mr-1"}),"Edit"]}),e.jsx(d,{variant:"outline",size:"sm",onClick:()=>Pe(s),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(Xe,{className:"h-4 w-4"})})]})]},s.id))})]})})]}),(n==null?void 0:n.has_profile_hours)&&e.jsxs(y,{className:"border-0 shadow-lg bg-blue-50",children:[e.jsxs(F,{children:[e.jsxs(O,{className:"flex items-center gap-3 text-lg text-blue-800",children:[e.jsx(g,{className:"h-5 w-5"}),"Profile Working Hours (Reference)"]}),e.jsx("p",{className:"text-sm text-blue-600",children:"These are the hours set in the dentist's profile"})]}),e.jsx(b,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:Object.entries(n.profile_working_hours).map(([s,t])=>e.jsx("div",{className:`p-3 rounded-lg border ${t?"bg-white border-blue-200":"bg-gray-100 border-gray-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-sm capitalize text-gray-700",children:s}),t?e.jsxs("span",{className:"text-xs text-blue-600 font-medium",children:[t.start," ","-"," ",t.end]}):e.jsx("span",{className:"text-xs text-gray-500",children:"Off"})]})},s))})})]})]}):e.jsx(y,{children:e.jsxs(b,{className:"text-center py-12",children:[e.jsx("div",{className:"p-4 bg-gray-100 rounded-full w-20 h-20 mx-auto mb-4 flex items-center justify-center",children:e.jsx(g,{className:"h-8 w-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Select a Dentist"}),e.jsx("p",{className:"text-gray-500",children:"Choose a dentist from the list above to view their schedules"})]})})}),U==="templates"&&e.jsx(pe,{className:"space-y-4",children:e.jsxs(y,{children:[e.jsxs(F,{children:[e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-5 w-5 text-indigo-600"}),"Schedule Templates"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Pre-configured schedule templates for quick setup. Select a template to apply to a dentist's schedule."})]}),e.jsx(b,{children:i?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(g,{className:"h-4 w-4 text-blue-600"}),e.jsxs("span",{className:"font-medium text-blue-900",children:["Applying to:"," ",(se=N.find(s=>s.id.toString()===i))==null?void 0:se.name]})]}),e.jsx("p",{className:"text-sm text-blue-700",children:"Select a template below to quickly set up this dentist's schedule."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:fe.map(s=>e.jsx(y,{className:"hover:shadow-md transition-shadow border-2 hover:border-indigo-200",children:e.jsxs(b,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.description})]}),e.jsx("div",{className:"p-2 bg-indigo-100 rounded-full",children:e.jsx(E,{className:"h-4 w-4 text-indigo-600"})})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("h4",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Schedule Details:"}),e.jsx("div",{className:"space-y-1",children:s.schedule.map((t,l)=>e.jsxs("div",{className:"text-xs text-gray-600 flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-indigo-400 rounded-full"}),e.jsxs("span",{className:"font-medium",children:[q(t.day),":"]}),e.jsxs("span",{children:[t.start," ","-"," ",t.end]})]},l))})]}),e.jsxs(d,{onClick:()=>ke(s),className:`w-full ${i?"bg-indigo-600 hover:bg-indigo-700":"bg-gray-400 hover:bg-gray-500"}`,size:"sm",disabled:!i,children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Apply Template"]})]})},s.id))})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"p-4 bg-gray-100 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(g,{className:"h-8 w-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Select a Dentist First"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Choose a dentist from the list above to apply templates to their schedule."})]})})]})})]})]})}),e.jsx(le,{open:Ne,onOpenChange:C,children:e.jsxs(re,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ie,{children:[e.jsx(ne,{children:"Apply Schedule Template"}),e.jsxs(de,{children:[!i&&e.jsx("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsx("p",{className:"text-yellow-800 text-sm",children:"âš ï¸ Please select a dentist first before applying a template."})}),w?e.jsxs(e.Fragment,{children:["Apply the"," ",e.jsx("strong",{children:w.name})," ","template to"," ",i?e.jsx("strong",{children:(te=N.find(s=>s.id.toString()===i))==null?void 0:te.name}):"the selected dentist",". This will create schedules for all days defined in the template."]}):"Select a template to apply to the dentist's schedule."]})]}),w?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-sm text-gray-900 mb-2",children:"Template Details:"}),e.jsx("div",{className:"space-y-1",children:w.schedule.map((s,t)=>e.jsxs("div",{className:"text-sm text-gray-600",children:[q(s.day),":"," ",s.start," - ",s.end]},t))})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(d,{variant:"outline",onClick:()=>{S(null)},children:"Back to Templates"}),e.jsx(d,{onClick:()=>{C(!1),S(null)},children:"Cancel"}),e.jsx(d,{onClick:Te,disabled:!i||G,className:"bg-indigo-600 hover:bg-indigo-700",children:G?"Applying Template...":"Apply Template"})]})]}):e.jsx("div",{className:"space-y-4",children:i?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(g,{className:"h-4 w-4 text-blue-600"}),e.jsxs("span",{className:"font-medium text-blue-900",children:["Applying to:"," ",(ae=N.find(s=>s.id.toString()===i))==null?void 0:ae.name]})]}),e.jsx("p",{className:"text-sm text-blue-700",children:"Choose a template below to quickly set up this dentist's schedule."})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:fe.map(s=>e.jsx(y,{className:"hover:shadow-md transition-shadow border-2 hover:border-indigo-200 cursor-pointer",onClick:()=>S(s),children:e.jsxs(b,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.description})]}),e.jsx("div",{className:"p-2 bg-indigo-100 rounded-full",children:e.jsx(E,{className:"h-4 w-4 text-indigo-600"})})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("h4",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Schedule Details:"}),e.jsx("div",{className:"space-y-1",children:s.schedule.map((t,l)=>e.jsxs("div",{className:"text-xs text-gray-600 flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-indigo-400 rounded-full"}),e.jsxs("span",{className:"font-medium",children:[q(t.day),":"]}),e.jsxs("span",{children:[t.start," ","-"," ",t.end]})]},l))})]}),e.jsxs(d,{onClick:t=>{t.stopPropagation(),S(s)},className:"w-full bg-indigo-600 hover:bg-indigo-700",size:"sm",children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Select This Template"]})]})},s.id))}),e.jsx("div",{className:"flex justify-end",children:e.jsx(d,{variant:"outline",onClick:()=>C(!1),children:"Cancel"})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"p-4 bg-gray-100 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(g,{className:"h-8 w-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Select a Dentist First"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Please select a dentist from the main page before applying templates."}),e.jsx(d,{variant:"outline",onClick:()=>C(!1),children:"Close"})]})})]})}),e.jsx(le,{open:ve,onOpenChange:s=>{p(s),s||(console.log("ðŸšª Dialog closed - clearing editingSchedule"),_(null),j())},children:e.jsxs(re,{className:"max-h-[90vh] overflow-y-auto max-w-2xl",children:[e.jsxs(ie,{children:[e.jsx(ne,{children:u?"Edit Schedule":"Create Schedule"}),e.jsx(de,{children:u?"Update the schedule details for the selected dentist.":f?"Create schedules for multiple days with the same settings.":"Create a new schedule entry for the selected dentist."}),!u&&e.jsxs("div",{className:"flex items-center space-x-2 mt-3 p-3 bg-blue-50 rounded-lg",children:[e.jsx(W,{checked:f,onCheckedChange:s=>{L(s),s||I([])}}),e.jsx(m,{className:"text-sm font-medium text-blue-700",children:"Quick Setup - Create for multiple days"})]})]}),e.jsxs("div",{className:"space-y-6 py-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Dentist"}),e.jsxs(ce,{value:a.user_id,onValueChange:s=>x("user_id",s),disabled:u!==null,children:[e.jsx(oe,{children:e.jsx(me,{placeholder:"Select dentist"})}),e.jsx(he,{children:N.map(s=>e.jsx(xe,{value:s.id.toString(),children:s.name},s.id))})]})]}),f&&!u?e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Select Days"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:z.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:`day-${s.value}`,checked:h.includes(s.value),onChange:t=>{t.target.checked?I([...h,s.value]):I(h.filter(l=>l!==s.value))},className:"rounded border-gray-300"}),e.jsx(m,{htmlFor:`day-${s.value}`,className:"text-sm",children:s.label})]},s.value))}),e.jsx("p",{className:"text-xs text-gray-500",children:"Select multiple days to create schedules with the same settings"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Day of Week"}),e.jsxs(ce,{value:a.day_of_week,onValueChange:s=>x("day_of_week",s),children:[e.jsx(oe,{children:e.jsx(me,{placeholder:"Select day"})}),e.jsx(he,{children:z.map(s=>e.jsx(xe,{value:s.value.toString(),children:s.label},s.value))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Start Time"}),e.jsx(A,{type:"time",value:a.start_time,onChange:s=>x("start_time",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"End Time"}),e.jsx(A,{type:"time",value:a.end_time,onChange:s=>x("end_time",s.target.value)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Buffer Time (minutes)"}),e.jsx(A,{type:"number",min:"0",max:"60",value:a.buffer_time,onChange:s=>x("buffer_time",parseInt(s.target.value)||15),placeholder:"15"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Time between appointments"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Slot Duration (minutes)"}),e.jsx(A,{type:"number",min:"15",max:"240",value:a.slot_duration,onChange:s=>x("slot_duration",parseInt(s.target.value)||30),placeholder:"30"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Default appointment length"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Maximum Appointments Per Day (optional)"}),e.jsx(A,{type:"number",min:"1",max:"50",value:a.max_appointments_per_day||"",onChange:s=>x("max_appointments_per_day",s.target.value?parseInt(s.target.value):null),placeholder:"Leave empty for no limit"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Limit the number of appointments for this day"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Notes (optional)"}),e.jsx(A,{type:"text",value:a.notes||"",onChange:s=>x("notes",s.target.value),placeholder:"Add any special notes for this schedule",maxLength:"1000"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Special instructions or notes"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(W,{checked:a.is_available,onCheckedChange:s=>x("is_available",s)}),e.jsx(m,{children:"Available for appointments"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(W,{checked:a.allow_overlap||!1,onCheckedChange:s=>x("allow_overlap",s)}),e.jsx(m,{children:"Allow overlapping appointments"}),e.jsx("p",{className:"text-xs text-gray-500 ml-2",children:"(Advanced: allows double-booking)"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(d,{variant:"outline",onClick:()=>{p(!1),j(),_(null),L(!1),I([])},children:"Cancel"}),e.jsx(d,{onClick:Ae,disabled:H||B||R,children:B?f&&h.length>1?`Creating ${h.length} Schedules...`:"Creating...":R?"Updating...":H?"Saving...":u?"Update Schedule":f&&h.length>1?`Create ${h.length} Schedules`:"Create Schedule"})]})]})]})})]})}export{Bs as default};
