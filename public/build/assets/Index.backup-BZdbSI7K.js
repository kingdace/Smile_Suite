import{r as o,v as ce,j as e,$ as me,m as ue}from"./app-39CltzEZ.js";import{A as pe}from"./AuthenticatedLayout-DAIL1WSW.js";import{C as xe,a as be,b as ge,c as he}from"./card-BLkHE8sY.js";import{B as g}from"./button-DZ_gML5Q.js";import{u as fe,a as K,D as ye,c as je,S as ve,v as we,b as Ne,s as ke,K as Ce,P as Se,d as _e,C as De}from"./sortable.esm-ByyfYHTf.js";import{M as Ee,T as Oe,a as Ie,L as Le}from"./leaflet-Crxc8eN2.js";import{I as W}from"./image-C2Lqkfjg.js";import{X as I}from"./x-CqBn5iPF.js";import{C as Pe}from"./copy-sqWM7x_9.js";import{c as Re}from"./createLucideIcon-xeUr5X85.js";import{u as Ae}from"./hooks-C-3r2wDX.js";import"./index-_tIDeRDz.js";import"./layout-dashboard-Dp9LfgaF.js";import"./users-dGa3C9VZ.js";import"./calendar-BbVrfnTN.js";import"./clock-BBc8nnP2.js";import"./stethoscope-D2JWLnHx.js";import"./scissors-BOi86H-6.js";import"./dollar-sign-DQvL8DQu.js";import"./chevron-right-CWYJv26h.js";import"./shield-GvYRLlTB.js";import"./trending-up-BDvcMIUS.js";import"./circle-alert-D2uNRAFV.js";import"./loader-circle-BAcDSp6x.js";import"./SiteHeader-DtlqUCBU.js";import"./index-CFS1jKyZ.js";import"./user-D35wEu3C.js";import"./crown-C5pvfQnJ.js";import"./zap-C5ILOiJW.js";import"./circle-check-big-CimBC4wv.js";import"./info-ZkN8-IGL.js";import"./circle-x-C4YgnnCA.js";import"./building-2-BeTWUnmZ.js";import"./file-text-FuBW91uK.js";import"./triangle-alert-BjwR-vki.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],Me=Re("grip-vertical",Fe);function kt({user:p,clinic:r,users:w,plan:Ue,limit:qe,count:Ge,errors:x,success:L,auth:H}){const N=p.role==="clinic_admin",V=o.useRef(),P=o.useRef(),{data:n,setData:d,post:X,processing:B}=ce({clinic_name:(r==null?void 0:r.name)||"",contact_number:(r==null?void 0:r.contact_number)||"",email:(r==null?void 0:r.email)||"",license_number:(r==null?void 0:r.license_number)||"",description:(r==null?void 0:r.description)||"",logo:null,latitude:(r==null?void 0:r.latitude)||"",longitude:(r==null?void 0:r.longitude)||"",name:p.name,user_email:p.email,password:"",password_confirmation:"",operating_hours:(r==null?void 0:r.operating_hours)||{}}),b=[{id:"monday",label:"Monday"},{id:"tuesday",label:"Tuesday"},{id:"wednesday",label:"Wednesday"},{id:"thursday",label:"Thursday"},{id:"friday",label:"Friday"},{id:"saturday",label:"Saturday"},{id:"sunday",label:"Sunday"}],[c,h]=o.useState(()=>{const t={};return b.forEach(a=>{t[a.id]={open:"",close:"",closed:!0}}),r.operating_hours&&Object.entries(r.operating_hours).forEach(([a,s])=>{Array.isArray(s)&&s.length===2?t[a]={open:s[0],close:s[1],closed:!1}:t[a]={open:"",close:"",closed:!0}}),t}),[R,Y]=o.useState([]),[f,J]=o.useState(""),[y,Z]=o.useState(""),[A,F]=o.useState({}),[M,T]=o.useState(!1),[U,k]=o.useState(""),[j,C]=o.useState([]),[q,S]=o.useState(null),[G,_]=o.useState(null),[z,ze]=o.useState(r.gallery_images||[]),[m,ee]=o.useState(z.map(t=>t.id));o.useRef();const te=fe(K(Se),K(Ce,{coordinateGetter:ke})),se=()=>{h(t=>{const a={...t};return R.forEach(s=>{a[s]={open:f,close:y,closed:!1}}),a})},D=(t,a,s)=>{h(l=>{const i={...l,[t]:{...l[t],[a]:s,closed:a==="closed"?s:l[t].closed}};return F($(i)),i})},ae=t=>{if(t===0)return;const a=b[t-1].id;h(s=>({...s,[b[t].id]:{...s[a]}}))},re=()=>{!f||!y||h(t=>{const a={...t};return b.forEach(s=>{a[s.id]={open:f,close:y,closed:!1}}),F($(a)),a})},$=t=>{const a={};return Object.entries(t).forEach(([s,{open:l,close:i,closed:u}])=>{!u&&l&&i&&l>=i&&(a[s]="Open time must be before close time.")}),a},le=t=>{t.preventDefault(),d("operating_hours",Object.fromEntries(Object.entries(c).map(([a,{open:s,close:l,closed:i}])=>i?[a,null]:[a,[s,l]]))),X(route("clinic.profile.update"),{forceFormData:!0})};function oe(t){if(k(""),!t.length)return;const a=t.map(s=>({file:s,preview:URL.createObjectURL(s)}));C(a)}function Q({src:t,alt:a}){const[s,l]=o.useState(!1),[i,u]=o.useState(0);return o.useEffect(()=>{if(s&&i<5){const E=setTimeout(()=>{l(!1),u(O=>O+1)},1e3*(i+1));return()=>clearTimeout(E)}},[s,i]),s&&i>=5?e.jsx("div",{className:"text-xs text-red-500",children:"Image not available"}):e.jsx("img",{src:t,alt:a,onError:()=>l(!0),style:{width:"100%",height:"100%"},className:"object-cover w-full h-full rounded-lg"})}function ie({img:t,idx:a,onDelete:s,onLightbox:l}){const{attributes:i,listeners:u,setNodeRef:E,transform:O,transition:ne,isDragging:de}=_e({id:t.id});return e.jsxs("div",{ref:E,style:{transform:De.Transform.toString(O),transition:ne,zIndex:de?10:1,minWidth:0},className:"relative group w-full h-24 md:h-28 bg-white rounded-lg overflow-hidden border border-blue-100 shadow-sm flex items-center justify-center transition-all duration-200 focus:ring-2 focus:ring-blue-400 hover:border-blue-400 cursor-pointer",tabIndex:0,role:"button","aria-label":"View image",onClick:()=>l(t.image_url),onKeyDown:v=>{(v.key==="Enter"||v.key===" ")&&l(t.image_url)},children:[e.jsx(Q,{src:t.image_url,alt:"Gallery"}),e.jsx("button",{type:"button",className:"absolute top-1.5 right-1.5 bg-white/90 hover:bg-red-500 hover:text-white text-gray-700 rounded-full p-1 shadow border border-gray-200",title:"Remove image from gallery","aria-label":"Remove image from gallery",onClick:v=>{v.stopPropagation(),s(t.id)},children:e.jsx(I,{className:"w-4 h-4"})}),e.jsx("span",{...i,...u,className:"absolute bottom-1.5 left-1.5 cursor-grab bg-white/80 rounded-full p-1 shadow text-blue-400 hover:bg-blue-100",title:"Drag to reorder","aria-label":"Drag to reorder",children:e.jsx(Me,{className:"w-4 h-4"})})]})}return e.jsxs(pe,{auth:H,children:[e.jsx(me,{title:"Profile"}),e.jsxs("div",{className:"max-w-5xl mx-auto py-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:N?"Clinic Profile":"My Profile"}),L&&e.jsx("div",{className:"mb-4 text-green-600 bg-green-50 border border-green-200 rounded p-2",children:L}),x&&Object.keys(x).length>0&&e.jsx("div",{className:"mb-4 text-red-600 bg-red-50 border border-red-200 rounded p-2",children:Object.values(x).map((t,a)=>e.jsx("div",{children:t},a))}),e.jsxs(xe,{className:"mb-8",children:[e.jsx(be,{children:e.jsx(ge,{children:N?"Clinic Information":"User Information"})}),e.jsx(he,{children:e.jsxs("form",{onSubmit:le,className:"space-y-4",children:[N&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block font-semibold mb-1",children:"Clinic Name"}),e.jsx("input",{type:"text",className:"w-full border px-3 py-2",value:n.clinic_name,onChange:t=>d("clinic_name",t.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-semibold mb-1",children:"Contact Number"}),e.jsx("input",{type:"text",className:"w-full border px-3 py-2",value:n.contact_number,onChange:t=>d("contact_number",t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-semibold mb-1",children:"Email"}),e.jsx("input",{type:"email",className:"w-full border px-3 py-2",value:n.email,onChange:t=>d("email",t.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-semibold mb-1",children:"License Number"}),e.jsx("input",{type:"text",className:"w-full border px-3 py-2",value:n.license_number,onChange:t=>d("license_number",t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-semibold mb-1",children:"Description"}),e.jsx("textarea",{className:"w-full border px-3 py-2",value:n.description,onChange:t=>d("description",t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-semibold mb-1",children:"Clinic Logo"}),e.jsx("input",{type:"file",ref:V,className:"w-full",accept:"image/*",onChange:t=>d("logo",t.target.files[0])}),e.jsx("img",{src:(r==null?void 0:r.logo_url)||"/images/clinic-logo.png",alt:"Clinic Logo",className:"h-20 mt-2 rounded object-cover",onError:t=>{t.target.src="/images/clinic-logo.png"}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-semibold mb-1",children:"Latitude"}),e.jsx("input",{type:"text",className:"w-full border px-3 py-2",value:n.latitude,onChange:t=>d("latitude",t.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-semibold mb-1",children:"Longitude"}),e.jsx("input",{type:"text",className:"w-full border px-3 py-2",value:n.longitude,onChange:t=>d("longitude",t.target.value),required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block font-semibold mb-1",children:"Set Location on Map"}),e.jsxs(Ee,{center:[parseFloat(n.latitude)||13.41,parseFloat(n.longitude)||122.56],zoom:15,style:{height:"250px",width:"100%"},children:[e.jsx(Oe,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),e.jsx(Te,{position:n.latitude&&n.longitude?[parseFloat(n.latitude),parseFloat(n.longitude)]:null,setPosition:([t,a])=>{d("latitude",t.toFixed(6)),d("longitude",a.toFixed(6))}})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow p-5 mb-8 border border-blue-100",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-extrabold text-blue-900 flex items-center gap-2 mb-1",children:[e.jsx(W,{className:"w-6 h-6 text-blue-400"})," ","Gallery"]}),e.jsx("div",{className:"text-gray-500 text-sm font-medium",children:"Drag & drop or click to upload. Drag images to reorder. Max 8 images."})]}),e.jsxs("span",{className:"inline-block bg-blue-100 text-blue-700 text-xs font-semibold px-2 py-0.5 rounded-full shadow-sm",children:[m.length," / 8"]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("input",{type:"file",accept:"image/*",multiple:!0,style:{display:"none"},ref:P,onChange:t=>{oe(Array.from(t.target.files)),t.target.value=""}}),e.jsx(g,{type:"button",onClick:()=>P.current.click(),className:"mb-2",variant:"outline",children:"Upload Images"}),e.jsx("span",{className:"text-xs text-gray-500 ml-2",children:"Max 8 images. Drag to reorder."})]}),e.jsx(ye,{sensors:te,collisionDetection:je,onDragEnd:t=>{const{active:a,over:s}=t;if(a.id!==(s==null?void 0:s.id)){const l=m.indexOf(a.id),i=m.indexOf(s.id),u=Ne(m,l,i);ee(u)}},children:e.jsx(ve,{items:m,strategy:we,children:e.jsx("div",{className:"grid grid-cols-4 gap-2 mb-2",children:m.length>0?m.map((t,a)=>{const s=z.find(l=>l.id===t||!l.id&&t.startsWith("temp-"));return s?e.jsx(ie,{img:s,idx:a,onDelete:S,onLightbox:_},s.id||`temp-${a}-${t}`):null}):e.jsxs("div",{className:"col-span-4 text-gray-400 italic flex items-center gap-2 justify-center min-h-[60px]",children:[e.jsx(W,{className:"w-5 h-5"})," ","No images yet."]})})})}),G&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70",onClick:()=>_(null),tabIndex:-1,"aria-modal":"true",role:"dialog",children:[e.jsx("img",{src:G,alt:"Large view",className:"max-w-[90vw] max-h-[80vh] rounded-lg shadow-lg border-4 border-white",onClick:t=>t.stopPropagation()}),e.jsx("button",{className:"absolute top-4 right-4 bg-white/80 hover:bg-red-500 hover:text-white text-gray-700 rounded-full p-2 shadow",onClick:()=>_(null),"aria-label":"Close",children:e.jsx(I,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"flex flex-wrap gap-3 mb-3",children:j.length>0&&e.jsxs("div",{className:"mb-2 flex flex-wrap gap-3",children:[j.map((t,a)=>e.jsxs("div",{className:"relative w-28 aspect-[4/3] rounded-lg overflow-hidden border border-green-300 flex items-center justify-center",children:[e.jsx(Q,{src:t.preview,alt:"Preview"}),e.jsx("button",{type:"button",className:"absolute top-1 right-1 bg-white/80 hover:bg-red-500 hover:text-white text-gray-700 rounded-full p-1 shadow transition",title:"Remove",onClick:()=>C(j.filter((s,l)=>l!==a)),children:e.jsx(I,{className:"w-4 h-4"})})]},a)),e.jsx(g,{type:"button",className:"h-10 mt-2",disabled:M,onClick:async()=>{k(""),T(!0);let t=!0;for(const a of j){const s=new FormData;s.append("image",a.file),(await fetch(route("clinic.profile.gallery.upload"),{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector("meta[name=csrf-token]").content},body:s,credentials:"same-origin"})).ok||(t=!1,k("One or more uploads failed. Please check file type/size."))}T(!1),C([]),t&&window.location.reload()},children:M?"Uploading...":"Upload"})]})}),U&&e.jsx("div",{className:"text-xs text-red-600 mb-2",children:U}),q&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",role:"dialog","aria-modal":"true",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-xs w-full",children:[e.jsx("h3",{className:"font-bold text-lg mb-2",children:"Remove Image?"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Are you sure you want to remove this image from the gallery?"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(g,{onClick:()=>S(null),variant:"secondary",children:"Cancel"}),e.jsx(g,{onClick:async()=>{await fetch(route("clinic.profile.gallery.delete",{id:q}),{method:"DELETE",headers:{"X-CSRF-TOKEN":document.querySelector("meta[name=csrf-token]").content}}),S(null),ue.reload()},variant:"destructive",children:"Remove"})]})]})})]})]}),e.jsxs("div",{className:"border-t pt-6 mt-6",children:[e.jsx("label",{className:"block font-semibold mb-2 text-lg",children:"Operating Hours"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-4 bg-blue-50 p-3 rounded-lg border border-blue-100",children:[e.jsx("span",{className:"font-medium mr-2",children:"Quick Setup:"}),b.map(t=>e.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium",children:[e.jsx("input",{type:"checkbox",checked:R.includes(t.id),onChange:a=>Y(s=>a.target.checked?[...s,t.id]:s.filter(l=>l!==t.id)),"aria-label":`Select ${t.label} for quick setup`}),t.label.slice(0,3)]},t.id)),e.jsx("input",{type:"time",value:f,onChange:t=>J(t.target.value),className:"border px-2 py-1 rounded w-20 ml-2 text-sm",placeholder:"Open","aria-label":"Quick open time"}),e.jsx("span",{children:"-"}),e.jsx("input",{type:"time",value:y,onChange:t=>Z(t.target.value),className:"border px-2 py-1 rounded w-20 text-sm",placeholder:"Close","aria-label":"Quick close time"}),e.jsx("button",{type:"button",className:"ml-2 bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-xs font-semibold shadow",onClick:se,"aria-label":"Apply quick setup to selected days",children:"Apply to Selected"}),e.jsx("button",{type:"button",className:"ml-2 bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-xs font-semibold shadow",onClick:re,"aria-label":"Set all days to quick setup times",children:"Set All"})]}),e.jsx("div",{className:"flex flex-col gap-1",children:b.map((t,a)=>e.jsxs("div",{className:"flex flex-wrap md:flex-nowrap items-center bg-gray-50 border border-gray-100 rounded-lg px-2 py-1 gap-2 hover:bg-blue-50 transition relative",children:[e.jsx("input",{type:"checkbox",checked:!c[t.id].closed,onChange:s=>D(t.id,"closed",!s.target.checked),className:"mr-2 scale-90","aria-label":`Toggle ${t.label} open/closed`}),e.jsx("span",{className:"font-semibold text-sm w-20",children:t.label}),c[t.id].closed?e.jsx("span",{className:"ml-2 px-2 py-0.5 bg-red-100 text-red-700 rounded-full text-xs font-semibold","aria-label":"Closed",children:"Closed"}):null,e.jsx("input",{type:"time",value:c[t.id].open,onChange:s=>D(t.id,"open",s.target.value),disabled:c[t.id].closed,className:"border px-2 py-1 rounded w-20 text-sm","aria-label":`${t.label} open time`}),e.jsx("span",{className:"mx-1",children:"-"}),e.jsx("input",{type:"time",value:c[t.id].close,onChange:s=>D(t.id,"close",s.target.value),disabled:c[t.id].closed,className:"border px-2 py-1 rounded w-20 text-sm","aria-label":`${t.label} close time`}),a>0&&e.jsx("button",{type:"button",className:"ml-auto p-1 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-full border border-gray-300 flex items-center justify-center",onClick:()=>ae(a),"aria-label":`Copy previous day's hours to ${t.label}`,title:"Copy previous day's hours",children:e.jsx(Pe,{className:"w-4 h-4"})}),A[t.id]&&e.jsx("span",{className:"ml-2 text-red-600 text-xs font-semibold","aria-live":"polite",children:A[t.id]})]},t.id))}),e.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"Example: Use Quick Setup to check Tuesday to Sunday and set 08:00 - 05:00 PM for each. Leave Monday unchecked for closed."}),x&&x.operating_hours&&e.jsx("div",{className:"text-red-600 text-sm mt-2",children:x.operating_hours})]}),e.jsx(g,{type:"submit",disabled:B,children:"Update Profile"})]})})]})]})]})}function Te({position:p,setPosition:r}){return Ae({click(w){r([w.latlng.lat,w.latlng.lng])}}),p?e.jsx(Ie,{position:p,icon:new Le.Icon({iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",shadowSize:[41,41]})}):null}export{kt as default};
