import{r as n,j as e,R as G,m as V,v as de,$ as ue}from"./app-COgprWRc.js";import{A as me}from"./AuthenticatedLayout-dRy-4ZNL.js";import"./card-Cds0mozr.js";import{B as $}from"./button-C4x32toX.js";import{I as X}from"./input-CRK1qwfu.js";import{L as U}from"./label-CTNxxOq2.js";import{E as he}from"./eye-off-C04AWDC5.js";import{E as oe}from"./eye-bgxnOJDp.js";import{C as W}from"./circle-x-DtgngRz6.js";import{C as J}from"./circle-check-big-BEuPoBvy.js";import{L as te}from"./loader-circle-BYoX5k2w.js";import{C as pe}from"./copy-FolXjlv0.js";import{M as xe,T as ge,a as fe,L as be}from"./leaflet-DTJjQA_D.js";import{u as ye}from"./hooks-C3uVTk62.js";import{u as ee,T as ie}from"./toast-BHb_jENy.js";import{u as je,a as re,D as we,c as Ne,S as ve,v as Ce,s as ke,K as Se,P as _e,d as Fe,C as De}from"./sortable.esm-D_PFW5iz.js";import{U as Ee}from"./upload-UVQYs8eG.js";import{X as ae}from"./x-tpI0RCzt.js";import{T as ce}from"./trash-2-DPZcB3mS.js";import{L as Pe}from"./lock-B11i-VOR.js";import{T as Le}from"./textarea-CpzJVOns.js";import{P as ne}from"./plus-TBOa98Pg.js";import{C as se}from"./calendar-DTUZZUoj.js";import{S as Oe}from"./square-pen-BME7W8Bt.js";import{B as $e}from"./building-2-DowVwInN.js";import{U as Ie}from"./user-CKZ_iwGK.js";import{C as Me}from"./clock-BraSIhTw.js";import{M as Te}from"./map-pin-D9QiDC3_.js";import{I as Ae}from"./image-B8iCkbKJ.js";import{S as le}from"./save-DXzj37OM.js";import"./index-kSaTWtOi.js";import"./layout-dashboard-DkARQqpT.js";import"./createLucideIcon-D0PSxBrC.js";import"./users-B4ViSBmW.js";import"./stethoscope-CbVKrnQ4.js";import"./scissors-sHvigQVN.js";import"./dollar-sign-DezZlbBG.js";import"./chevron-right-BBfU1Lxm.js";import"./shield-D4m3gq8y.js";import"./trending-up-3gLa3GYu.js";import"./circle-alert-DCUkzB6T.js";import"./SiteHeader-CDBukgQi.js";import"./index-Chr4fCpz.js";import"./crown-CNoFtN5r.js";import"./zap-CDqFRYPk.js";import"./info-Div9PQlp.js";import"./file-text-BTyeLFET.js";import"./triangle-alert-CmgfC4Xa.js";function K({name:s,type:t="text",label:a,placeholder:h,value:c,onChange:u,onBlur:o,error:p,isValid:d,isInvalid:b,isValidating:f,required:m=!1,disabled:S=!1,className:w="",inputClassName:E="",showPasswordToggle:C=!1,...l}){const[F,x]=n.useState(!1),[g,_]=n.useState(!1),r=C&&t==="password"?F?"text":"password":t,y=()=>{let v=`block w-full px-4 py-3 border rounded-xl shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-offset-2 transition-all duration-300 ${E}`;return S?v+=" bg-gray-50 text-gray-500 cursor-not-allowed":b?v+=" border-red-300 focus:border-red-500 focus:ring-red-500 bg-red-50":d?v+=" border-green-300 focus:border-green-500 focus:ring-green-500 bg-green-50":g?v+=" border-blue-300 focus:border-blue-500 focus:ring-blue-500 bg-blue-50":v+=" border-gray-300 focus:border-blue-500 focus:ring-blue-500 hover:border-gray-400",v},i=()=>f?"text-blue-500":b?"text-red-500":d?"text-green-500":"text-gray-400",N=()=>f?e.jsx(te,{className:"h-5 w-5 animate-spin"}):b?e.jsx(W,{className:"h-5 w-5"}):d?e.jsx(J,{className:"h-5 w-5"}):null;return e.jsxs("div",{className:`space-y-3 ${w}`,children:[a&&e.jsxs("label",{htmlFor:s,className:"block text-sm font-semibold text-gray-800",children:[a,m&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:s,name:s,type:r,value:c,onChange:u,onBlur:v=>{_(!1),o==null||o(v)},onFocus:()=>_(!0),placeholder:h,disabled:S,className:y(),...l}),(f||b||d)&&e.jsx("div",{className:`absolute inset-y-0 right-0 pr-3 flex items-center ${i()}`,children:N()}),C&&t==="password"&&e.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-10 flex items-center text-gray-400 hover:text-gray-600",onClick:()=>x(!F),children:F?e.jsx(he,{className:"h-5 w-5"}):e.jsx(oe,{className:"h-5 w-5"})})]}),p&&e.jsxs("p",{className:"text-sm text-red-600 flex items-center bg-red-50 px-3 py-2 rounded-lg border border-red-200",children:[e.jsx(W,{className:"h-4 w-4 mr-2 flex-shrink-0"}),p]}),d&&!p&&e.jsxs("p",{className:"text-sm text-green-600 flex items-center bg-green-50 px-3 py-2 rounded-lg border border-green-200",children:[e.jsx(J,{className:"h-4 w-4 mr-2 flex-shrink-0"}),"Looks good!"]})]})}function Ue({name:s,label:t,placeholder:a,value:h,onChange:c,onBlur:u,error:o,isValid:p,isInvalid:d,isValidating:b,required:f=!1,disabled:m=!1,rows:S=3,className:w="",inputClassName:E="",...C}){const[l,F]=n.useState(!1),x=()=>{let r=`block w-full px-3 py-2 border rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors duration-200 resize-vertical ${E}`;return m?r+=" bg-gray-50 text-gray-500 cursor-not-allowed":d?r+=" border-red-300 focus:border-red-500 focus:ring-red-500":p?r+=" border-green-300 focus:border-green-500 focus:ring-green-500":l?r+=" border-blue-300 focus:border-blue-500 focus:ring-blue-500":r+=" border-gray-300 focus:border-blue-500 focus:ring-blue-500",r},g=()=>b?"text-blue-500":d?"text-red-500":p?"text-green-500":"text-gray-400",_=()=>b?e.jsx(te,{className:"h-5 w-5 animate-spin"}):d?e.jsx(W,{className:"h-5 w-5"}):p?e.jsx(J,{className:"h-5 w-5"}):null;return e.jsxs("div",{className:`space-y-3 ${w}`,children:[t&&e.jsxs("label",{htmlFor:s,className:"block text-sm font-semibold text-gray-800",children:[t,f&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{id:s,name:s,value:h,onChange:c,onBlur:r=>{F(!1),u==null||u(r)},onFocus:()=>F(!0),placeholder:a,disabled:m,rows:S,className:x(),...C}),(b||d||p)&&e.jsx("div",{className:`absolute top-3 right-3 ${g()}`,children:_()})]}),o&&e.jsxs("p",{className:"text-sm text-red-600 flex items-center bg-red-50 px-3 py-2 rounded-lg border border-red-200",children:[e.jsx(W,{className:"h-4 w-4 mr-2 flex-shrink-0"}),o]}),p&&!o&&e.jsxs("p",{className:"text-sm text-green-600 flex items-center bg-green-50 px-3 py-2 rounded-lg border border-green-200",children:[e.jsx(J,{className:"h-4 w-4 mr-2 flex-shrink-0"}),"Looks good!"]})]})}function ze({data:s,setData:t,errors:a,isAdmin:h,validateField:c,getFieldError:u,isFieldValid:o,isFieldInvalid:p,isFieldValidating:d}){const b=n.useRef(),f=(m,S)=>{t(m,S),c(m,S,{...s,[m]:S})};return h?e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(K,{name:"clinic_name",label:"Clinic Name",type:"text",value:s.clinic_name||"",onChange:m=>f("clinic_name",m.target.value),error:u("clinic_name")||a.clinic_name,isValid:o("clinic_name"),isInvalid:p("clinic_name"),isValidating:d("clinic_name"),required:!0,placeholder:"Enter clinic name"}),e.jsx(K,{name:"contact_number",label:"Contact Number",type:"tel",value:s.contact_number||"",onChange:m=>f("contact_number",m.target.value),error:u("contact_number")||a.contact_number,isValid:o("contact_number"),isInvalid:p("contact_number"),isValidating:d("contact_number"),placeholder:"09XX-XXX-XXXX"}),e.jsx(K,{name:"clinic_email",label:"Email",type:"email",value:s.clinic_email||"",onChange:m=>f("clinic_email",m.target.value),error:u("clinic_email")||a.clinic_email,isValid:o("clinic_email"),isInvalid:p("clinic_email"),isValidating:d("clinic_email"),required:!0,placeholder:"clinic@example.com"}),e.jsx(K,{name:"license_number",label:"License Number",type:"text",value:s.license_number||"",onChange:m=>f("license_number",m.target.value),error:u("license_number")||a.license_number,isValid:o("license_number"),isInvalid:p("license_number"),isValidating:d("license_number"),placeholder:"DOH-123456"})]}),e.jsx(Ue,{name:"description",label:"Description",value:s.description||"",onChange:m=>f("description",m.target.value),error:u("description")||a.description,isValid:o("description"),isInvalid:p("description"),isValidating:d("description"),rows:3,placeholder:"Tell patients about your clinic..."}),e.jsxs("div",{children:[e.jsx(U,{htmlFor:"logo",className:"text-sm font-medium",children:"Clinic Logo"}),e.jsx(X,{ref:b,type:"file",accept:"image/*",onChange:m=>t("logo",m.target.files[0]),className:"mb-2"}),s.logo_url&&e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:s.logo_url,alt:"Clinic Logo",className:"h-20 w-20 rounded-lg object-cover border border-gray-200",onError:m=>{m.target.src="/images/clinic-logo.png"}})})]})]})}):null}const B=[{id:"monday",label:"Monday"},{id:"tuesday",label:"Tuesday"},{id:"wednesday",label:"Wednesday"},{id:"thursday",label:"Thursday"},{id:"friday",label:"Friday"},{id:"saturday",label:"Saturday"},{id:"sunday",label:"Sunday"}];function He(s={}){const[t,a]=n.useState(()=>{const x={};return B.forEach(g=>{x[g.id]={open:"",close:"",closed:!0}}),s&&Object.entries(s).forEach(([g,_])=>{Array.isArray(_)&&_.length===2?x[g]={open:_[0],close:_[1],closed:!1}:x[g]={open:"",close:"",closed:!0}}),x}),[h,c]=n.useState([]),[u,o]=n.useState(""),[p,d]=n.useState(""),[b,f]=n.useState({}),m=n.useCallback(x=>{const g={};return Object.entries(x).forEach(([_,{open:r,close:y,closed:i}])=>{!i&&r&&y&&r>=y&&(g[_]="Open time must be before close time.")}),g},[]),S=n.useCallback((x,g,_)=>{a(r=>{const y={...r,[x]:{...r[x],[g]:_,closed:g==="closed"?_:r[x].closed}};return f(m(y)),y})},[m]),w=n.useCallback(()=>{a(x=>{const g={...x};return h.forEach(_=>{g[_]={open:u,close:p,closed:!1}}),f(m(g)),g})},[h,u,p,m]),E=n.useCallback(x=>{if(x===0)return;const g=B[x-1].id;a(_=>({..._,[B[x].id]:{..._[g]}}))},[]),C=n.useCallback(()=>{!u||!p||a(x=>{const g={...x};return B.forEach(_=>{g[_.id]={open:u,close:p,closed:!1}}),f(m(g)),g})},[u,p,m]),l=n.useCallback(()=>Object.fromEntries(Object.entries(t).map(([x,{open:g,close:_,closed:r}])=>r?[x,null]:[x,[g,_]])),[t]),F=n.useCallback(x=>{if(!x)return"";let[g,_]=x.split(":");g=parseInt(g,10);const r=g>=12?"PM":"AM";return g=g%12,g===0&&(g=12),`${g}:${_} ${r}`},[]);return{operatingDays:t,quickDays:h,quickOpen:u,quickClose:p,validationErrors:b,setQuickDays:c,setQuickOpen:o,setQuickClose:d,handleOperatingDayChange:S,handleQuickApply:w,handleCopyPreviousDay:E,handleSetAll:C,formatOperatingHours:l,format12h:F,DAYS_OF_WEEK:B}}function Xe({initialOperatingHours:s={},errors:t={},onOperatingHoursChange:a}){const{operatingDays:h,quickDays:c,quickOpen:u,quickClose:o,validationErrors:p,setQuickDays:d,setQuickOpen:b,setQuickClose:f,handleOperatingDayChange:m,handleQuickApply:S,handleCopyPreviousDay:w,handleSetAll:E,DAYS_OF_WEEK:C}=He(s);return n.useEffect(()=>{if(a){const l=Object.fromEntries(Object.entries(h).map(([F,{open:x,close:g,closed:_}])=>_?[F,null]:[F,[x,g]]));a(l)}},[h]),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200 mb-6",children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-3",children:"Quick Setup"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx("span",{className:"text-sm font-medium text-blue-700",children:"Select days:"}),C.map(l=>e.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:c.includes(l.id),onChange:F=>d(x=>F.target.checked?[...x,l.id]:x.filter(g=>g!==l.id)),className:"rounded"}),l.label.slice(0,3)]},l.id))]}),e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[e.jsx("input",{type:"time",value:u,onChange:l=>b(l.target.value),className:"border border-blue-300 rounded px-2 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Open"}),e.jsx("span",{className:"text-blue-600",children:"-"}),e.jsx("input",{type:"time",value:o,onChange:l=>f(l.target.value),className:"border border-blue-300 rounded px-2 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Close"}),e.jsx($,{type:"button",onClick:S,size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Apply to Selected"}),e.jsx($,{type:"button",onClick:E,size:"sm",className:"bg-green-600 hover:bg-green-700 text-white",children:"Set All"})]})]}),e.jsx("div",{className:"space-y-2",children:C.map((l,F)=>e.jsxs("div",{className:"flex flex-wrap md:flex-nowrap items-center bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 gap-2 hover:bg-blue-50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:!h[l.id].closed,onChange:x=>m(l.id,"closed",!x.target.checked),className:"rounded scale-110"}),e.jsx("span",{className:"font-semibold text-sm w-20 min-w-[80px]",children:l.label}),h[l.id].closed?e.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-700 rounded-full text-xs font-semibold",children:"Closed"}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"time",value:h[l.id].open,onChange:x=>m(l.id,"open",x.target.value),className:"border border-gray-300 rounded px-2 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e.jsx("span",{className:"text-gray-500",children:"-"}),e.jsx("input",{type:"time",value:h[l.id].close,onChange:x=>m(l.id,"close",x.target.value),className:"border border-gray-300 rounded px-2 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),F>0&&e.jsx($,{type:"button",onClick:()=>w(F),size:"sm",variant:"outline",className:"ml-auto p-1 h-8 w-8",title:"Copy previous day's hours",children:e.jsx(pe,{className:"h-4 w-4"})}),p[l.id]&&e.jsx("span",{className:"text-red-500 text-xs font-medium",children:p[l.id]})]},l.id))}),e.jsx("div",{className:"text-xs text-gray-500 mt-3",children:"💡 Use Quick Setup to select multiple days and set the same hours for all of them."}),t.operating_hours&&e.jsx("div",{className:"text-red-500 text-sm mt-2",children:t.operating_hours})]})})}function qe(s="",t=""){const[a,h]=n.useState(s),[c,u]=n.useState(t),[o,p]=n.useState(!1),d=n.useCallback((C,l)=>{h(C.toFixed(6)),u(l.toFixed(6))},[]),b=n.useCallback(C=>{d(C.lat,C.lng)},[d]),f=n.useCallback(()=>{const C={};if(a){const l=parseFloat(a);(isNaN(l)||l<-90||l>90)&&(C.latitude="Latitude must be between -90 and 90")}if(c){const l=parseFloat(c);(isNaN(l)||l<-180||l>180)&&(C.longitude="Longitude must be between -180 and 180")}return C},[a,c]),m=n.useCallback(()=>{const C=parseFloat(a)||13.41,l=parseFloat(c)||122.56;return[C,l]},[a,c]),S=n.useCallback(()=>{const C=parseFloat(a),l=parseFloat(c);return!isNaN(C)&&!isNaN(l)&&C>=-90&&C<=90&&l>=-180&&l<=180},[a,c]),w=n.useCallback(()=>{h(s),u(t)},[s,t]),E=n.useCallback(()=>({latitude:a?parseFloat(a):null,longitude:c?parseFloat(c):null}),[a,c]);return{latitude:a,longitude:c,isMapLoading:o,setLatitude:h,setLongitude:u,updateCoordinates:d,handleMapClick:b,validateCoordinates:f,getMapCenter:m,hasValidCoordinates:S,resetCoordinates:w,getCoordinatesForSubmission:E,setIsMapLoading:p}}function Re({data:s,setData:t,errors:a}){const{getMapCenter:h}=qe(s.latitude,s.longitude),c=G.useCallback(o=>{t("latitude",o.lat.toFixed(6)),t("longitude",o.lng.toFixed(6))},[t]),u=G.useCallback(()=>{const o=parseFloat(s.latitude),p=parseFloat(s.longitude);return!isNaN(o)&&!isNaN(p)&&o>=-90&&o<=90&&p>=-180&&p<=180},[s.latitude,s.longitude]);return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(U,{htmlFor:"latitude",className:"text-sm font-medium",children:"Latitude"}),e.jsx(X,{id:"latitude",type:"text",value:s.latitude||"",onChange:o=>t("latitude",o.target.value),className:a.latitude?"border-red-500":"",placeholder:"13.4125"}),a.latitude&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.latitude})]}),e.jsxs("div",{children:[e.jsx(U,{htmlFor:"longitude",className:"text-sm font-medium",children:"Longitude"}),e.jsx(X,{id:"longitude",type:"text",value:s.longitude||"",onChange:o=>t("longitude",o.target.value),className:a.longitude?"border-red-500":"",placeholder:"122.5656"}),a.longitude&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.longitude})]})]}),e.jsxs("div",{children:[e.jsx(U,{className:"text-sm font-medium mb-2 block",children:"Set Location on Map"}),e.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:e.jsxs(xe,{center:h(),zoom:15,style:{height:"300px",width:"100%"},className:"z-0",children:[e.jsx(ge,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),e.jsx(Ge,{position:u()?[parseFloat(s.latitude),parseFloat(s.longitude)]:null,onMapClick:c})]})}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Click on the map to set your clinic's location. This helps patients find you easily."})]})]})})}function Ge({position:s,onMapClick:t}){return ye({click(a){t(a.latlng)}}),s?e.jsx(fe,{position:s,icon:new be.Icon({iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",shadowSize:[41,41]})}):null}function Ve(s=[]){const t=n.useRef(),{showSuccess:a,showWarning:h,showInfo:c}=ee(),[u,o]=n.useState(!1),[p,d]=n.useState(""),[b,f]=n.useState([]),[m,S]=n.useState(null),[w,E]=n.useState(null),[C,l]=n.useState(s),[F,x]=n.useState(s.map(D=>D.id)),g=n.useCallback(D=>{if(d(""),!D||!D.length)return;const M=Array.isArray(D)?D:Array.from(D),z=4*1024*1024,q=["image/jpeg","image/jpg","image/png","image/webp"],j=10,O=[],P=[];if(M.forEach((T,L)=>{if(T.size>z){P.push(`${T.name} is too large (max 4MB)`);return}if(!q.includes(T.type)){P.push(`${T.name} is not a supported image format`);return}O.push(T)}),O.length+b.length>j&&P.push(`Maximum ${j} images allowed`),P.length>0){d(P.join(", ")),h("Invalid Files",P.join(", "));return}if(O.length===0){h("No Valid Files","No valid image files were selected");return}const R=O.map(T=>({file:T,preview:URL.createObjectURL(T)}));f(T=>[...T,...R]),c("Files Selected",`${O.length} image(s) ready for upload`)},[b.length,h,c]),_=n.useCallback(async()=>{d(""),o(!0);let D=!0;for(const M of b){const z=new FormData;z.append("image",M.file);try{(await fetch(route("clinic.profile.gallery.upload"),{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector("meta[name=csrf-token]").content},body:z,credentials:"same-origin"})).ok||(D=!1,d("One or more uploads failed. Please check file type/size."))}catch{D=!1,d("Upload failed. Please try again.")}}o(!1),f([]),D&&(a("Upload Complete","Images uploaded successfully"),V.reload())},[b,a]),r=n.useCallback(D=>{E(D)},[]),y=n.useCallback(()=>{E(null)},[]),i=n.useCallback(async D=>{try{o(!0),(await fetch(route("clinic.profile.gallery.delete",{id:D}),{method:"DELETE",headers:{"X-CSRF-TOKEN":document.querySelector("meta[name=csrf-token]").content}})).ok?(E(null),a("Image Deleted","Image has been successfully removed"),V.reload()):d("Failed to delete image. Please try again.")}catch{d("Failed to delete image. Please try again.")}finally{o(!1)}},[a]),N=n.useCallback((D,M)=>{if(D!==M){const z=F.indexOf(D),q=F.indexOf(M),j=Qe(F,z,q);x(j)}},[F]),v=n.useCallback(D=>{S(D)},[]),k=n.useCallback(()=>{S(null)},[]),I=n.useCallback(()=>{b.forEach(D=>{D.preview&&URL.revokeObjectURL(D.preview)}),f([]),setUploadProgress(0),setUploadResults([]),d("")},[b]);return{galleryInputRef:t,galleryUploading:u,galleryError:p,galleryPreviews:b,showDeleteId:w,lightboxImg:m,galleryImages:C,galleryOrder:F,handleGalleryFiles:g,handleGalleryUpload:_,handleDeleteImage:i,handleGalleryReorder:N,openLightbox:v,closeLightbox:k,openDeleteConfirmation:r,closeDeleteConfirmation:y,setGalleryPreviews:f,clearPreviews:I}}function Qe(s,t,a){const h=s.slice();return h.splice(a,0,h.splice(t,1)[0]),h}function Be({initialGalleryImages:s=[],errors:t={},onGalleryChange:a}){const{toasts:h,removeToast:c}=ee(),{galleryInputRef:u,galleryUploading:o,galleryError:p,galleryPreviews:d,showDeleteId:b,lightboxImg:f,galleryImages:m,galleryOrder:S,handleGalleryFiles:w,handleGalleryUpload:E,handleDeleteImage:C,handleGalleryReorder:l,openLightbox:F,closeLightbox:x,openDeleteConfirmation:g,closeDeleteConfirmation:_,setGalleryPreviews:r,clearPreviews:y}=Ve(s);n.useEffect(()=>{a&&a(m)},[m,a]);const i=je(re(_e),re(Se,{coordinateGetter:ke}));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[e.jsx("input",{ref:u,type:"file",multiple:!0,accept:"image/*",onChange:N=>w(Array.from(N.target.files)),className:"hidden"}),e.jsxs($,{type:"button",onClick:()=>{var N;return(N=u.current)==null?void 0:N.click()},variant:"outline",className:"mb-4",children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"Upload Images"]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Upload multiple images to showcase your clinic"})]}),d.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-medium text-gray-700",children:["Preview (",d.length," files)"]}),e.jsx($,{type:"button",variant:"outline",size:"sm",onClick:y,disabled:o,children:"Clear All"})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:d.map((N,v)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:N.preview,alt:`Preview ${v+1}`,className:"w-full h-24 object-cover rounded-lg border"}),e.jsx($,{type:"button",size:"sm",variant:"destructive",className:"absolute -top-2 -right-2 h-6 w-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>{const k=d.filter((I,D)=>D!==v);r(k)},children:e.jsx(ae,{className:"h-3 w-3"})})]},v))}),e.jsx($,{type:"button",onClick:E,disabled:o||d.length===0,className:"w-full",children:o?"Uploading...":"Upload All Images"})]}),p&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsx("p",{className:"text-red-700 text-sm",children:p})}),m.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-gray-700",children:"Current Gallery"}),e.jsx(we,{sensors:i,collisionDetection:Ne,onDragEnd:N=>{const{active:v,over:k}=N;v.id!==(k==null?void 0:k.id)&&l(v.id,k.id)},children:e.jsx(ve,{items:S,strategy:Ce,children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:S.map(N=>{const v=m.find(k=>k.id===N);return v?e.jsx(Ke,{image:v,onView:()=>F(v.image_url),onDelete:()=>g(N)},N):null})})})})]}),f&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:e.jsxs("div",{className:"relative max-w-4xl max-h-full p-4",children:[e.jsx($,{type:"button",onClick:x,className:"absolute -top-2 -right-2 bg-white text-black hover:bg-gray-100",size:"sm",children:e.jsx(ae,{className:"h-4 w-4"})}),e.jsx("img",{src:f,alt:"Gallery",className:"max-w-full max-h-full rounded-lg"})]})}),b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-sm w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Delete Image"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to delete this image? This action cannot be undone."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx($,{type:"button",onClick:_,variant:"outline",className:"flex-1",children:"Cancel"}),e.jsx($,{type:"button",onClick:()=>{o||C(b)},variant:"destructive",className:"flex-1",disabled:o,children:o?"Deleting...":"Delete"})]})]})}),t.gallery&&e.jsx("div",{className:"text-red-500 text-sm",children:t.gallery})]}),e.jsx(ie,{toasts:h,onRemoveToast:c})]})}function Ke({image:s,onView:t,onDelete:a}){const{attributes:h,listeners:c,setNodeRef:u,transform:o,transition:p,isDragging:d}=Fe({id:s.id}),b={transform:De.Transform.toString(o),transition:p,opacity:d?.5:1};return e.jsxs("div",{className:"relative group",children:[e.jsxs("div",{ref:u,style:b,...h,...c,className:"cursor-move",children:[e.jsx("img",{src:s.image_url,alt:s.alt_text||"Gallery image",className:"w-full h-24 object-cover rounded-lg border"}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all duration-200 rounded-lg flex items-center justify-center",children:e.jsx("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity flex gap-2",children:e.jsx($,{type:"button",size:"sm",variant:"secondary",onClick:t,className:"h-8 w-8 p-0",children:e.jsx(oe,{className:"h-4 w-4"})})})})]}),e.jsx($,{type:"button",size:"sm",variant:"destructive",onClick:a,className:"absolute -top-2 -right-2 h-6 w-6 p-0 z-20 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(ce,{className:"h-3 w-3"})})]})}function Ye({data:s,setData:t,errors:a,isAdmin:h}){return h?e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(U,{htmlFor:"name",className:"text-sm font-medium",children:"Full Name *"}),e.jsx(X,{id:"name",type:"text",value:s.name||"",onChange:c=>t("name",c.target.value),className:a.name?"border-red-500":"",required:!0}),a.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.name})]}),e.jsxs("div",{children:[e.jsx(U,{htmlFor:"email",className:"text-sm font-medium",children:"Email *"}),e.jsx(X,{id:"email",type:"email",value:s.email||"",onChange:c=>t("email",c.target.value),className:a.email?"border-red-500":"",required:!0}),a.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.email})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("h4",{className:"font-medium text-gray-700 mb-3 flex items-center gap-2",children:[e.jsx(Pe,{className:"h-4 w-4"}),"Change Password"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(U,{htmlFor:"password",className:"text-sm font-medium",children:"New Password"}),e.jsx(X,{id:"password",type:"password",value:s.password||"",onChange:c=>t("password",c.target.value),className:a.password?"border-red-500":"",placeholder:"Leave blank to keep current password"}),a.password&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.password})]}),e.jsxs("div",{children:[e.jsx(U,{htmlFor:"password_confirmation",className:"text-sm font-medium",children:"Confirm New Password"}),e.jsx(X,{id:"password_confirmation",type:"password",value:s.password_confirmation||"",onChange:c=>t("password_confirmation",c.target.value),className:a.password_confirmation?"border-red-500":"",placeholder:"Confirm new password"}),a.password_confirmation&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.password_confirmation})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Leave password fields blank if you don't want to change your password."})]})]})}):null}function Ze({clinicId:s,initialHolidays:t=[],errors:a={},showSuccess:h,showError:c}){const[u,o]=n.useState(t),[p,d]=n.useState(!1),[b,f]=n.useState(null),[m,S]=n.useState(null),[w,E]=n.useState({name:"",date:"",is_recurring:!1,description:""}),[C,l]=n.useState(!1),{showSuccess:F,showError:x}=ee(),g=h||F,_=c||x,r=u.length,y=u.filter(j=>j.is_recurring).length,i=u.filter(j=>j.is_active===!1).length,N=(()=>{const j=new Date,O=u.filter(P=>P.is_active!==!1).map(P=>({...P,_date:new Date(P.date)})).filter(P=>!isNaN(P._date)).filter(P=>P._date>=new Date(j.toDateString())).sort((P,R)=>P._date-R._date)[0];if(!O)return null;try{return new Date(O.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}catch{return O.date}})(),v=async()=>{if(!(!w.name||!w.date||!s)){l(!0);try{await V.post(route("clinic.holidays.store",s),w,{preserveState:!0,onSuccess:j=>{var P,R;const O=((R=(P=j==null?void 0:j.props)==null?void 0:P.flash)==null?void 0:R.holiday)||null;o(T=>[...T,O||{id:Date.now(),...w,is_active:!0}]),g("Holiday added","The holiday has been saved."),E({name:"",date:"",is_recurring:!1,description:""}),d(!1)},onError:()=>_("Failed","Could not add holiday."),onFinish:()=>l(!1)})}catch{l(!1)}}},k=j=>{f(j),E({name:j.name,date:j.date,is_recurring:j.is_recurring,description:j.description||""}),d(!0)},I=async()=>{if(!(!w.name||!w.date||!s||!b)){l(!0);try{await V.put(route("clinic.holidays.update",[s,b.id]),w,{preserveState:!0,onSuccess:()=>{o(j=>j.map(O=>O.id===b.id?{...O,...w}:O)),g("Holiday updated","Changes have been saved."),E({name:"",date:"",is_recurring:!1,description:""}),d(!1),f(null)},onError:()=>_("Failed","Could not update holiday."),onFinish:()=>l(!1)})}catch{l(!1)}}},D=async j=>{if(!(!s||!j)){l(!0);try{await V.delete(route("clinic.holidays.destroy",[s,j]),{preserveState:!0,onSuccess:()=>{o(O=>O.filter(P=>P.id!==j)),g("Holiday deleted","The holiday was removed."),S(null)},onError:()=>_("Failed","Could not delete holiday."),onFinish:()=>l(!1)})}catch{l(!1)}}},M=j=>S(j),z=()=>S(null),q=()=>{E({name:"",date:"",is_recurring:!1,description:""}),d(!1),f(null)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:["Holidays",r>0&&e.jsxs("span",{className:"inline-flex items-center text-xs font-medium px-2 py-0.5 rounded-full bg-blue-50 text-blue-700 border border-blue-200",children:[r," total"]})]}),r>0&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-gray-600",children:[e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full bg-gray-50 border border-gray-200",children:["Recurring: ",y]}),e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full bg-gray-50 border border-gray-200",children:["Inactive: ",i]}),N&&e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full bg-emerald-50 text-emerald-700 border border-emerald-200",children:["Next: ",N]})]})]}),!p&&e.jsxs($,{type:"button",onClick:()=>d(!0),className:"md:w-auto",disabled:C,children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Add Holiday"]})]}),p&&e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[e.jsx("h4",{className:"font-medium text-gray-700 mb-4",children:b?"Edit Holiday":"Add New Holiday"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(U,{htmlFor:"holiday_name",className:"text-sm font-medium",children:"Holiday Name *"}),e.jsx(X,{id:"holiday_name",type:"text",value:w.name,onChange:j=>E({...w,name:j.target.value}),placeholder:"e.g., Christmas Day",required:!0})]}),e.jsxs("div",{children:[e.jsx(U,{htmlFor:"holiday_date",className:"text-sm font-medium",children:"Date *"}),e.jsx(X,{id:"holiday_date",type:"date",value:w.date,onChange:j=>E({...w,date:j.target.value}),required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(U,{htmlFor:"holiday_description",className:"text-sm font-medium",children:"Description"}),e.jsx(Le,{id:"holiday_description",value:w.description,onChange:j=>E({...w,description:j.target.value}),rows:2,placeholder:"Optional description..."})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:w.is_recurring,onChange:j=>E({...w,is_recurring:j.target.checked}),className:"rounded"}),e.jsx("span",{className:"text-sm font-medium",children:"Recurring holiday (every year)"})]})})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx($,{type:"button",onClick:b?I:v,className:"bg-blue-600 hover:bg-blue-700 text-white",children:b?"Update Holiday":"Add Holiday"}),e.jsx($,{type:"button",onClick:q,variant:"outline",children:"Cancel"})]})]}),u.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-semibold text-gray-800",children:"Current Holidays"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[u.length," ",u.length===1?"entry":"entries"]})]}),u.map(j=>{const O=new Date(j.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return e.jsxs("div",{className:"grid grid-cols-[auto_1fr_auto] items-center gap-4 bg-white border border-gray-200 rounded-xl p-4 shadow-sm hover:shadow transition-all",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-50 flex items-center justify-center",children:e.jsx(se,{className:"h-5 w-5 text-blue-500"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h5",{className:"font-semibold text-gray-900 truncate",children:j.name}),j.is_recurring&&e.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 rounded-full text-xs font-semibold",children:"Recurs yearly"}),j.is_active===!1&&e.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 rounded-full text-xs font-semibold",children:"Inactive"})]}),e.jsx("div",{className:"text-sm text-gray-600",children:O}),j.description&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:j.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx($,{type:"button",onClick:()=>k(j),size:"sm",variant:"outline",className:"h-8 px-2",children:e.jsx(Oe,{className:"h-4 w-4"})}),e.jsx($,{type:"button",onClick:()=>M(j.id),size:"sm",variant:"destructive",className:"h-8 px-2",disabled:C,children:e.jsx(ce,{className:"h-4 w-4"})})]})]},j.id)})]}),u.length===0&&!p&&e.jsxs("div",{className:"flex flex-col items-center justify-center text-center py-16 rounded-xl border border-dashed border-gray-200 bg-gradient-to-b from-white to-gray-50",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center mb-4",children:e.jsx(se,{className:"h-8 w-8 text-gray-400"})}),e.jsx("h4",{className:"text-gray-800 font-semibold mb-1",children:"No holidays configured yet"}),e.jsx("p",{className:"text-sm text-gray-600 max-w-md mb-6",children:"Add holidays to automatically block bookings on those dates for this clinic. You can set one-time or recurring holidays."}),e.jsxs($,{type:"button",onClick:()=>d(!0),className:"px-5",disabled:C,children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Add Holiday"]})]}),a.holidays&&e.jsx("div",{className:"text-red-500 text-sm",children:a.holidays})]}),m&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-sm w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Delete Holiday"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to delete this holiday? This action cannot be undone."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx($,{type:"button",onClick:z,variant:"outline",className:"flex-1",children:"Cancel"}),e.jsx($,{type:"button",onClick:()=>D(m),variant:"destructive",className:"flex-1",disabled:C,children:C?"Deleting...":"Delete"})]})]})})]})}const Y={email:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,phone:/^[\+]?[1-9][\d]{0,15}$/,password:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]/,strongPassword:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/},A={required:"This field is required",email:"Please enter a valid email address",phone:"Please enter a valid phone number",password:"Password must contain at least one uppercase letter, one lowercase letter, one number, and one special character",strongPassword:"Password must be at least 8 characters and contain uppercase, lowercase, number, and special character",minLength:s=>`Must be at least ${s} characters long`,maxLength:s=>`Must be no more than ${s} characters long`,min:s=>`Must be at least ${s}`,max:s=>`Must be no more than ${s}`,pattern:"Please enter a valid format",match:"Values do not match",unique:"This value is already taken",futureDate:"Please select a future date",pastDate:"Please select a past date",age:s=>`Must be at least ${s} years old`},Z={required:s=>!s||typeof s=="string"&&s.trim()===""?A.required:null,email:s=>s&&!Y.email.test(s)?A.email:null,phone:s=>s&&!Y.phone.test(s.replace(/[\s\-\(\)]/g,""))?A.phone:null,password:s=>s&&!Y.password.test(s)?A.password:null,strongPassword:s=>s&&!Y.strongPassword.test(s)?A.strongPassword:null,minLength:s=>t=>t&&t.length<s?A.minLength(s):null,maxLength:s=>t=>t&&t.length>s?A.maxLength(s):null,min:s=>t=>{const a=Number(t);return t&&!isNaN(a)&&a<s?A.min(s):null},max:s=>t=>{const a=Number(t);return t&&!isNaN(a)&&a>s?A.max(s):null},pattern:(s,t=A.pattern)=>a=>a&&!s.test(a)?t:null,match:(s,t=A.match)=>a=>a&&a!==s?t:null,futureDate:s=>s&&new Date(s)<=new Date?A.futureDate:null,pastDate:s=>s&&new Date(s)>=new Date?A.pastDate:null,age:s=>t=>{if(t){const a=new Date(t),h=new Date,c=h.getFullYear()-a.getFullYear(),u=h.getMonth()-a.getMonth();if((u<0||u===0&&h.getDate()<a.getDate())&&c--,c<s)return A.age(s)}return null},coordinate:s=>{if(!s)return null;const t=parseFloat(s);return isNaN(t)||t<-90||t>90?"Invalid coordinate value":null},phone:s=>s?/^[\+]?[1-9][\d]{0,15}$/.test(s.replace(/[\s\-\(\)]/g,""))?null:"Please enter a valid phone number":null,match:s=>t=>t!==s?"Values do not match":null,custom:s=>s},We=(s={},t={})=>{const[a,h]=n.useState(s),[c,u]=n.useState({}),[o,p]=n.useState({}),[d,b]=n.useState(!1),[f,m]=n.useState(0),S=n.useCallback((i,N)=>{const v=t[i]||[];for(const k of v){let I=null;if(typeof k=="string"&&Z[k])I=Z[k](N);else if(typeof k=="function")I=k(N);else if(k&&typeof k=="object"&&k.type&&Z[k.type]){const D=Z[k.type];I=typeof D=="function"?D(k.value)(N):D(N)}if(I)return I}return null},[t]),w=n.useCallback(()=>{const i={};let N=!0;return Object.keys(t).forEach(v=>{const k=S(v,a[v]);k&&(i[v]=k,N=!1)}),u(i),N},[a,t,S]),E=n.useCallback((i,N)=>{h(v=>({...v,[i]:N})),c[i]&&u(v=>({...v,[i]:null}))},[c]),C=n.useCallback(i=>{h(N=>({...N,...i}))},[h]),l=n.useCallback(i=>{p(v=>({...v,[i]:!0}));const N=S(i,a[i]);N&&u(v=>({...v,[i]:N}))},[a,S]),F=n.useCallback((i,N)=>{E(i,N)},[E]),x=n.useCallback(()=>{h(s),u({}),p({}),b(!1),m(0)},[s]),g=n.useCallback(async i=>{b(!0),m(k=>k+1);const N=Object.keys(t).reduce((k,I)=>(k[I]=!0,k),{});p(N);const v=w();if(v&&i)try{await i(a)}catch(k){console.error("Form submission error:",k)}return b(!1),v},[a,w,t]),_=n.useCallback(i=>({value:a[i]||"",onChange:N=>F(i,N.target.value),onBlur:()=>l(i),error:o[i]?c[i]:null,touched:o[i]||!1}),[a,c,o,F,l]),r=Object.keys(c).length===0&&Object.keys(t).every(i=>a[i]&&a[i].toString().trim()!==""),y={totalFields:Object.keys(t).length,completedFields:Object.keys(t).filter(i=>a[i]&&a[i].toString().trim()!=="").length,errorFields:Object.keys(c).length,touchedFields:Object.keys(o).length,completionPercentage:Math.round(Object.keys(t).filter(i=>a[i]&&a[i].toString().trim()!=="").length/Object.keys(t).length*100)};return{values:a,errors:c,touched:o,isSubmitting:d,submitCount:f,isValid:r,setValue:E,setMultipleValues:C,handleChange:F,handleBlur:l,handleSubmit:g,reset:x,validateForm:w,validateField:S,getFieldProps:_,formStats:y}};function Je(){const{validateEmail:s,validatePhone:t,errors:a,setError:h,clearError:c}=We(),[u,o]=n.useState({}),[p,d]=n.useState({}),[b,f]=n.useState({}),m=n.useCallback((r,y,i,N=500)=>{b[r]&&clearTimeout(b[r]),d(k=>({...k,[r]:"validating"}));const v=setTimeout(()=>{const k=i(y,r);d(I=>({...I,[r]:k?"invalid":"valid"})),o(I=>({...I,[r]:k})),k?h(r,k):c(r)},N);f(k=>({...k,[r]:v}))},[b,h,c]),S={clinic_name:(r,y)=>!r||r.trim()===""?`${y} is required`:r.length<2?`${y} must be at least 2 characters`:r.length>100?`${y} must be less than 100 characters`:null,name:(r,y)=>!r||r.trim()===""?`${y} is required`:r.length<2?`${y} must be at least 2 characters`:r.length>100?`${y} must be less than 100 characters`:null,email:(r,y)=>!r||r.trim()===""||s(r)?null:"Please enter a valid email address",clinic_email:(r,y)=>!r||r.trim()===""||s(r)?null:"Please enter a valid email address",phone:(r,y)=>!r||r.trim()===""||t(r)?null:"Please enter a valid Philippine phone number (e.g., 09XX-XXX-XXXX)",contact_number:(r,y)=>!r||r.trim()===""||t(r)?null:"Please enter a valid Philippine phone number (e.g., 09XX-XXX-XXXX)",address:(r,y)=>!r||r.trim()===""?`${y} is required`:r.length<10?`${y} must be at least 10 characters`:null,license_number:(r,y)=>!r||r.trim()===""?null:r.length<3?`${y} must be at least 3 characters`:null,description:(r,y)=>!r||r.trim()===""?null:r.length>500?`${y} must be less than 500 characters`:null,website:(r,y)=>{if(!r||r.trim()==="")return null;try{return new URL(r),null}catch{return"Please enter a valid website URL (e.g., https://example.com)"}},latitude:(r,y)=>{if(!r||r.trim()==="")return null;const i=parseFloat(r);return isNaN(i)?"Latitude must be a valid number":i<-90||i>90?"Latitude must be between -90 and 90":null},longitude:(r,y)=>{if(!r||r.trim()==="")return null;const i=parseFloat(r);return isNaN(i)?"Longitude must be a valid number":i<-180||i>180?"Longitude must be between -180 and 180":null},password:(r,y)=>!r||r.trim()===""?null:r.length<8?"Password must be at least 8 characters":/(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/.test(r)?null:"Password must contain at least one uppercase letter, one lowercase letter, and one number",password_confirmation:(r,y,i)=>!r||r.trim()===""?null:i.password&&r!==i.password?"Passwords do not match":null},w=n.useCallback((r,y,i={})=>{const N=S[r];N&&(r==="password_confirmation"?m(r,y,v=>N(v,r,i)):m(r,y,v=>N(v,r)))},[m,S]),E=n.useCallback(r=>{d(y=>({...y,[r]:"idle"})),o(y=>{const i={...y};return delete i[r],i}),c(r)},[c]),C=n.useCallback(r=>p[r]||"idle",[p]),l=n.useCallback(r=>u[r]||a[r]||null,[u,a]),F=n.useCallback(r=>C(r)==="valid"&&!l(r),[C,l]),x=n.useCallback(r=>C(r)==="invalid"||!!l(r),[C,l]),g=n.useCallback(r=>C(r)==="validating",[C]),_=n.useCallback(()=>{d({}),o({}),Object.values(b).forEach(r=>clearTimeout(r)),f({})},[b]);return n.useEffect(()=>()=>{Object.values(b).forEach(r=>clearTimeout(r))},[b]),{validateField:w,clearFieldValidation:E,clearAllValidations:_,getFieldState:C,getFieldError:l,isFieldValid:F,isFieldInvalid:x,isFieldValidating:g,fieldErrors:u,fieldStates:p}}function es({size:s="default",className:t=""}){const a={sm:"h-4 w-4",default:"h-6 w-6",lg:"h-8 w-8",xl:"h-12 w-12"};return e.jsx(te,{className:`animate-spin ${a[s]} ${t}`})}function ss({loading:s=!1,children:t,loadingText:a="Loading...",className:h="",...c}){return e.jsx("button",{...c,disabled:s,className:`relative inline-flex items-center justify-center ${h}`,children:s?e.jsxs(e.Fragment,{children:[e.jsx(es,{size:"sm",className:"mr-2"}),e.jsx("span",{children:a})]}):t})}function ts({progress:s=0,className:t="",showPercentage:a=!0}){return e.jsxs("div",{className:`w-full bg-gray-200 rounded-full h-2 ${t}`,children:[e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300 ease-out",style:{width:`${Math.min(100,Math.max(0,s))}%`}}),a&&e.jsxs("div",{className:"text-xs text-gray-600 mt-1 text-center",children:[Math.round(s),"%"]})]})}function Zs({user:s,clinic:t,users:a,plan:h,limit:c,count:u,errors:o,success:p,auth:d}){const b=s.role==="clinic_admin",[f,m]=n.useState(()=>new URLSearchParams(window.location.search).get("tab")||"clinic"),{data:S,setData:w,post:E}=de({clinic_name:(t==null?void 0:t.name)||"",contact_number:(t==null?void 0:t.contact_number)||"",clinic_email:(t==null?void 0:t.email)||"",license_number:(t==null?void 0:t.license_number)||"",description:(t==null?void 0:t.description)||"",logo:null,latitude:(t==null?void 0:t.latitude)||"",longitude:(t==null?void 0:t.longitude)||"",name:s.name,email:s.email,password:"",password_confirmation:"",operating_hours:(t==null?void 0:t.operating_hours)||{},gallery_images:(t==null?void 0:t.gallery_images)||[],active_tab:f}),[C,l]=n.useState({}),[F,x]=n.useState(!1),[g,_]=n.useState(0),{validateField:r,getFieldError:y,isFieldValid:i,isFieldInvalid:N,isFieldValidating:v}=Je(),{toasts:k,removeToast:I,showSuccess:D,showError:M}=ee(),[z,q]=n.useState(!1),j=(L,H)=>{w(L,H),r(L,H,{...S,[L]:H})},O=L=>{if(L.preventDefault(),f==="clinic"){if(!S.clinic_name||S.clinic_name.trim()===""){M("Validation Error","Clinic name is required.");return}if(!S.clinic_email||S.clinic_email.trim()===""){M("Validation Error","Clinic email is required.");return}}x(!0),_(0);const H=setInterval(()=>{_(Q=>Q>=90?(clearInterval(H),Q):Q+10)},100);E(route("clinic.profile.update"),{...S,active_tab:f,forceFormData:!0,onSuccess:()=>{clearInterval(H),_(100),D("Success","Profile updated successfully!"),setTimeout(()=>{x(!1),V.reload()},500)},onError:Q=>{clearInterval(H),x(!1),console.log("Backend validation errors:",Q),M("Update Failed","Please check the errors and try again.")}})},P=[{id:"clinic",label:"Clinic Settings",icon:$e,description:"Manage clinic information and settings"},{id:"user",label:"User Account",icon:Ie,description:"Manage your user account"},{id:"hours",label:"Operating Hours",icon:Me,description:"Set clinic operating hours"},{id:"location",label:"Location",icon:Te,description:"Set clinic location on map"},{id:"gallery",label:"Gallery",icon:Ae,description:"Manage clinic gallery images"},{id:"holidays",label:"Holidays",icon:se,description:"Manage clinic holidays"}];G.useEffect(()=>{t&&t.name&&w(L=>({...L,clinic_name:t.name||"",contact_number:t.contact_number||"",clinic_email:t.email||"",license_number:t.license_number||"",description:t.description||"",latitude:t.latitude||"",longitude:t.longitude||"",operating_hours:t.operating_hours||{},gallery_images:t.gallery_images||[]}))},[t,w]),G.useEffect(()=>{w("active_tab",f)},[f,w]),G.useEffect(()=>{const L=new URL(window.location);L.searchParams.set("tab",f),window.history.replaceState({},"",L)},[f]);const R=G.useCallback(L=>{w("operating_hours",L)},[w]),T=G.useCallback(L=>{w("gallery_images",L)},[w]);return e.jsxs(me,{auth:d,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Clinic Profile"}),children:[e.jsx(ue,{title:"Clinic Profile"}),e.jsx("div",{className:"py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[p&&e.jsx("div",{className:"mb-6 bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-xl p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-green-800",children:p})})]})}),o.message&&e.jsx("div",{className:"mb-6 bg-gradient-to-r from-red-50 to-rose-50 border border-red-200 rounded-xl p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-red-800",children:o.message})})]})}),e.jsxs("div",{className:"bg-white overflow-hidden shadow-xl sm:rounded-2xl border border-gray-100 max-w-6xl mx-auto",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-b border-gray-200",children:e.jsx("nav",{className:"flex justify-center space-x-1 sm:space-x-2 px-4 sm:px-6 py-2 overflow-x-auto",children:P.map(L=>{const H=L.icon;return e.jsxs("button",{onClick:()=>m(L.id),className:`relative py-3 px-3 sm:px-4 md:px-6 font-medium text-xs sm:text-sm flex items-center justify-center gap-1 sm:gap-2 md:gap-3 transition-all duration-200 rounded-t-lg whitespace-nowrap min-w-[80px] sm:min-w-[100px] flex-shrink-0 ${f===L.id?"bg-white text-blue-700 shadow-sm border-t-2 border-l-2 border-r-2 border-blue-200 -mb-px":"text-gray-600 hover:text-blue-600 hover:bg-white/50"}`,children:[e.jsx(H,{className:`h-4 w-4 sm:h-5 sm:w-5 ${f===L.id?"text-blue-600":""}`}),L.label]},L.id)})})}),e.jsxs("div",{className:"p-6 sm:p-8 bg-gradient-to-br from-gray-50 to-white min-h-[600px] transition-all duration-300",children:[F&&e.jsxs("div",{className:"mb-6",children:[e.jsx(ts,{progress:g,className:"mb-2"}),e.jsx("p",{className:"text-sm text-gray-600 text-center",children:"Updating your profile..."})]}),e.jsxs("form",{onSubmit:O,className:"space-y-8",children:[f==="clinic"&&e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"bg-white rounded-xl p-6 sm:p-8 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300",children:e.jsx(ze,{data:S,setData:w,errors:o,isAdmin:b,validateField:r,getFieldError:y,isFieldValid:i,isFieldInvalid:N,isFieldValidating:v,handleInputChange:j})})}),f==="user"&&e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"bg-white rounded-xl p-6 sm:p-8 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300",children:e.jsx(Ye,{data:S,setData:w,errors:o,isAdmin:b})})}),f==="hours"&&e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"bg-white rounded-xl p-6 sm:p-8 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300",children:e.jsx(Xe,{initialOperatingHours:S.operating_hours,errors:o,onOperatingHoursChange:R})})}),f==="location"&&e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"bg-white rounded-xl p-6 sm:p-8 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300",children:e.jsx(Re,{data:S,setData:w,errors:o})})}),f==="gallery"&&e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"bg-white rounded-xl p-6 sm:p-8 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300",children:e.jsx(Be,{initialGalleryImages:(t==null?void 0:t.gallery_images)||[],errors:o,onGalleryChange:T})})}),f==="holidays"&&e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"bg-white rounded-xl p-6 sm:p-8 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300",children:e.jsx(Ze,{clinicId:t==null?void 0:t.id,initialHolidays:(t==null?void 0:t.holidays)||[],errors:o,showSuccess:D,showError:M})})}),e.jsx("div",{className:"bg-gradient-to-r from-blue-50 via-indigo-50 to-purple-10 rounded-2xl p-8 border border-blue-100 shadow-lg",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-6",children:[e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsxs("div",{className:"flex items-center justify-center sm:justify-start gap-3 mb-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-full flex items-center justify-center",children:e.jsx(le,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-bold text-gray-900",children:"Save Changes"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Update your clinic profile settings"})]})]}),F&&e.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"Please wait while we save your changes..."})]}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-3",children:e.jsxs(ss,{type:"submit",loading:F,loadingText:"Saving...",className:"bg-gradient-to-r from-blue-600 via-indigo-600 to-indigo-600 hover:from-blue-700 hover:via-indigo-700 hover:to-teal-700 text-white px-8 py-4 rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed min-w-[160px]",children:[e.jsx(le,{className:"h-5 w-5 mr-2"}),"Save Changes"]})})]})})]})]})]})]})}),e.jsx(ie,{toasts:k,onRemoveToast:I})]})}export{Zs as default};
