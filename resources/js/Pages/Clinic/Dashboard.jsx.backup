import AuthenticatedLayout from "@/Layouts/AuthenticatedLayout";
import { Head, Link } from "@inertiajs/react";
import { Card, CardContent, CardHeader, CardTitle } from "@/Components/ui/card";
import { Button } from "@/Components/ui/button";
import { Badge } from "@/Components/ui/badge";
import {
    Calendar,
    Users,
    Package,
    Clock,
    Plus,
    TrendingUp,
    DollarSign,
    Stethoscope,
    AlertTriangle,
    CheckCircle,
    XCircle,
    Star,
    Building2,
    Phone,
    Mail,
    MapPin,
    ArrowRight,
    Activity,
    UserCheck,
    CalendarDays,
    PackageCheck,
    FileText,
    BarChart3,
    Settings,
    Bell,
    Shield,
} from "lucide-react";
import { format } from "date-fns";

export default function Dashboard({
    auth,
    clinic,
    stats,
    today_appointments,
    upcoming_appointments,
    recent_patients,
    lowStockItems,
    todayTreatments,
}) {
    const getStatusColor = (statusId) => {
        const colors = {
            1: "bg-yellow-100 text-yellow-700 border-yellow-200", // Pending
            2: "bg-emerald-100 text-emerald-700 border-emerald-200", // Confirmed
            3: "bg-blue-100 text-blue-700 border-blue-200", // Completed
            4: "bg-red-100 text-red-700 border-red-200", // Cancelled
            5: "bg-gray-100 text-gray-700 border-gray-200", // No Show
        };
        return colors[statusId] || "bg-gray-100 text-gray-700 border-gray-200";
    };

    const getStatusIcon = (statusId) => {
        const icons = {
            1: Clock, // Pending
            2: CheckCircle, // Confirmed
            3: CheckCircle, // Completed
            4: XCircle, // Cancelled
            5: XCircle, // No Show
        };
        return icons[statusId] || Clock;
    };

    return (
        <AuthenticatedLayout auth={auth}>
            <Head title={`${clinic.name} - Dashboard`} />

            <div className="min-h-screen bg-gradient-to-br from-blue-50 via-cyan-50 to-white">
                {/* Modern Header Section */}
                <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
                    <div className="bg-gradient-to-r from-white via-blue-50/50 to-cyan-50/50 rounded-2xl border border-blue-200/50 shadow-lg backdrop-blur-sm">
                        <div className="p-6">
                            <div className="flex items-center justify-between gap-6">
                                <div className="flex items-center gap-4">
                                    <div className="p-2.5 rounded-xl bg-gradient-to-br from-blue-500 to-cyan-600 shadow-md">
                                        <Building2 className="h-5 w-5 text-white" />
                                    </div>
                                    <div>
                                        <h1 className="text-xl font-bold text-gray-900">
                                            Clinic Dashboard
                                        </h1>
                                        <div className="flex items-center gap-3 mt-1">
                                            <p className="text-sm text-gray-600">
                                                Welcome back, {auth?.user?.name}
                                            </p>
                                            <div className="w-1 h-1 bg-gray-400 rounded-full"></div>
                                            <p className="text-sm font-mono text-gray-600">
                                                {format(
                                                    new Date(),
                                                    "MMM d, yyyy"
                                                )}
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                <div className="flex items-center gap-3">
                                    <div className="text-right">
                                        <p className="text-xs text-gray-500">
                                            Subscription
                                        </p>
                                        <div className="mt-1">
                                            <Badge
                                                className={
                                                    clinic.subscription_status ===
                                                    "trial"
                                                        ? "bg-blue-100 text-blue-700 border-blue-200"
                                                        : "bg-emerald-100 text-emerald-700 border-emerald-200"
                                                }
                                            >
                                                {clinic.subscription_status ===
                                                "trial"
                                                    ? "Free Trial"
                                                    : "Active"}
                                            </Badge>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                {/* Trial Status Banner */}
                {clinic.subscription_status === "trial" && (
                    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-2">
                        <div className="bg-gradient-to-r from-blue-50 to-cyan-50 border-2 border-blue-200 rounded-xl p-4 shadow-sm">
                            <div className="flex items-center gap-3">
                                <div className="p-2 rounded-lg bg-blue-100">
                                    <Star className="h-5 w-5 text-blue-600" />
                                </div>
                                <div className="flex-1">
                                    <h3 className="text-lg font-bold text-blue-800">
                                        üéâ Free Trial Active
                                    </h3>
                                    <p className="text-blue-700 text-sm mt-1">
                                        You're currently on a 14-day free trial.
                                        {clinic.trial_ends_at && (
                                            <span className="font-semibold">
                                                {" "}
                                                Expires on{" "}
                                                {new Date(
                                                    clinic.trial_ends_at
                                                ).toLocaleDateString()}{" "}
                                                (
                                                {Math.max(
                                                    0,
                                                    Math.ceil(
                                                        (new Date(
                                                            clinic.trial_ends_at
                                                        ) -
                                                            new Date()) /
                                                            (1000 *
                                                                60 *
                                                                60 *
                                                                24)
                                                    )
                                                )}{" "}
                                                days left)
                                            </span>
                                        )}
                                    </p>
                                </div>
                                <Link
                                    href={route(
                                        "clinic.profile.index",
                                        clinic.id
                                    )}
                                    className="inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors duration-200 shadow-sm hover:shadow-md"
                                >
                                    <Settings className="h-4 w-4" />
                                    Manage Subscription
                                </Link>
                            </div>
                        </div>
                    </div>
                )}

                {/* Grace Period Banner */}
                {clinic.subscription_status === "grace_period" && (
                    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-2">
                        <div className="bg-gradient-to-r from-yellow-50 to-orange-50 border-2 border-yellow-200 rounded-xl p-4 shadow-sm">
                            <div className="flex items-center gap-3">
                                <div className="p-2 rounded-lg bg-yellow-100">
                                    <Clock className="h-5 w-5 text-yellow-600" />
                                </div>
                                <div className="flex-1">
                                    <h3 className="text-lg font-bold text-yellow-800">
                                        ‚è∞ Grace Period Active
                                    </h3>
                                    <p className="text-yellow-700 text-sm mt-1">
                                        Your subscription has expired. You have
                                        a 7-day grace period to renew.
                                        {clinic.subscription_end_date && (
                                            <span className="font-semibold">
                                                {" "}
                                                Grace period ends on{" "}
                                                {new Date(
                                                    clinic.subscription_end_date
                                                ).toLocaleDateString()}{" "}
                                                (
                                                {Math.max(
                                                    0,
                                                    Math.ceil(
                                                        (new Date(
                                                            clinic.subscription_end_date
                                                        ) -
                                                            new Date()) /
                                                            (1000 *
                                                                60 *
                                                                60 *
                                                                24)
                                                    )
                                                )}{" "}
                                                days left)
                                            </span>
                                        )}
                                    </p>
                                </div>
                                <Link
                                    href={route(
                                        "clinic.profile.index",
                                        clinic.id
                                    )}
                                    className="inline-flex items-center gap-2 px-4 py-2 bg-yellow-600 hover:bg-yellow-700 text-white font-semibold rounded-lg transition-colors duration-200 shadow-sm hover:shadow-md"
                                >
                                    <Settings className="h-4 w-4" />
                                    Renew Subscription
                                </Link>
                            </div>
                        </div>
                    </div>
                )}

                {/* Subscription Expiring Soon Banner */}
                {clinic.subscription_status === "active" &&
                    clinic.subscription_end_date &&
                    (() => {
                        const daysUntilExpiry = Math.ceil(
                            (new Date(clinic.subscription_end_date) -
                                new Date()) /
                                (1000 * 60 * 60 * 24)
                        );
                        if (daysUntilExpiry <= 7 && daysUntilExpiry > 0) {
                            return (
                                <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-2">
                                    <div className="bg-gradient-to-r from-orange-50 to-red-50 border-2 border-orange-200 rounded-xl p-4 shadow-sm">
                                        <div className="flex items-center gap-3">
                                            <div className="p-2 rounded-lg bg-orange-100">
                                                <AlertTriangle className="h-5 w-5 text-orange-600" />
                                            </div>
                                            <div className="flex-1">
                                                <h3 className="text-lg font-bold text-orange-800">
                                                    ‚ö†Ô∏è Subscription Expiring
                                                    Soon
                                                </h3>
                                                <p className="text-orange-700 text-sm mt-1">
                                                    Your subscription will
                                                    expire in {daysUntilExpiry}{" "}
                                                    day
                                                    {daysUntilExpiry !== 1
                                                        ? "s"
                                                        : ""}
                                                    .
                                                    <span className="font-semibold">
                                                        {" "}
                                                        Expires on{" "}
                                                        {new Date(
                                                            clinic.subscription_end_date
                                                        ).toLocaleDateString()}
                                                    </span>
                                                </p>
                                            </div>
                                            <Link
                                                href={route(
                                                    "clinic.profile.index",
                                                    clinic.id
                                                )}
                                                className="inline-flex items-center gap-2 px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white font-semibold rounded-lg transition-colors duration-200 shadow-sm hover:shadow-md"
                                            >
                                                <Settings className="h-4 w-4" />
                                                Renew Now
                                            </Link>
                                        </div>
                                    </div>
                                </div>
                            );
                        }
                        return null;
                    })()}

                {/* Subscription Status Card */}
                <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
                    <Card className="shadow-lg rounded-xl border-0 bg-white/90 backdrop-blur-sm overflow-hidden">
                        <CardHeader className="border-b-2 border-blue-200 pb-4 bg-gradient-to-r from-blue-100 to-indigo-100">
                            <div className="flex items-center justify-between">
                                <div className="flex items-center gap-3">
                                    <div className="p-2.5 rounded-lg bg-gradient-to-br from-blue-500 to-indigo-600 shadow-sm">
                                        <Shield className="h-5 w-5 text-white" />
                                    </div>
                                    <div>
                                        <CardTitle className="text-lg font-bold text-gray-900">
                                            Subscription Status
                                        </CardTitle>
                                        <p className="text-gray-600 text-sm mt-0.5">
                                            Current plan and duration
                                            information
                                        </p>
                                    </div>
                                </div>
                                <Link
                                    href={route(
                                        "clinic.profile.index",
                                        clinic.id
                                    )}
                                    className="inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors duration-200 shadow-sm hover:shadow-md"
                                >
                                    <Settings className="h-4 w-4" />
                                    Manage Subscription
                                </Link>
                            </div>
                        </CardHeader>
                        <CardContent className="pt-5">
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                                {/* Current Plan */}
                                <div className="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-4 border border-blue-200">
                                    <div className="flex items-center gap-3 mb-3">
                                        <div className="p-2 rounded-lg bg-blue-100">
                                            <Building2 className="h-4 w-4 text-blue-600" />
                                        </div>
                                        <h3 className="font-semibold text-gray-900">
                                            Current Plan
                                        </h3>
                                    </div>
                                    <div className="space-y-2">
                                        <div className="flex justify-between items-center">
                                            <span className="text-sm text-gray-600">
                                                Plan:
                                            </span>
                                            <Badge className="bg-blue-100 text-blue-700 border-blue-200">
                                                {clinic.subscription_plan
                                                    ? clinic.subscription_plan
                                                          .charAt(0)
                                                          .toUpperCase() +
                                                      clinic.subscription_plan.slice(
                                                          1
                                                      )
                                                    : "Basic"}
                                            </Badge>
                                        </div>
                                        <div className="flex justify-between items-center">
                                            <span className="text-sm text-gray-600">
                                                Status:
                                            </span>
                                            <Badge
                                                className={
                                                    clinic.subscription_status ===
                                                    "trial"
                                                        ? "bg-blue-100 text-blue-700 border-blue-200"
                                                        : clinic.subscription_status ===
                                                          "active"
                                                        ? "bg-green-100 text-green-700 border-green-200"
                                                        : clinic.subscription_status ===
                                                          "grace_period"
                                                        ? "bg-yellow-100 text-yellow-700 border-yellow-200"
                                                        : "bg-red-100 text-red-700 border-red-200"
                                                }
                                            >
                                                {clinic.subscription_status ===
                                                "trial"
                                                    ? "Free Trial"
                                                    : clinic.subscription_status ===
                                                      "active"
                                                    ? "Active"
                                                    : clinic.subscription_status ===
                                                      "grace_period"
                                                    ? "Grace Period"
                                                    : clinic.subscription_status ===
                                                      "suspended"
                                                    ? "Suspended"
                                                    : "Inactive"}
                                            </Badge>
                                        </div>
                                        <div className="flex justify-between items-center">
                                            <span className="text-sm text-gray-600">
                                                Price:
                                            </span>
                                            <span className="text-sm font-semibold text-gray-900">
                                                {clinic.subscription_plan ===
                                                "basic"
                                                    ? "‚Ç±999"
                                                    : clinic.subscription_plan ===
                                                      "premium"
                                                    ? "‚Ç±1,999"
                                                    : clinic.subscription_plan ===
                                                      "enterprise"
                                                    ? "‚Ç±2,999"
                                                    : "‚Ç±999"}
                                                /month
                                            </span>
                                        </div>
                                    </div>
                                </div>

                                {/* Trial Information */}
                                {clinic.subscription_status === "trial" &&
                                    clinic.trial_ends_at && (
                                        <div className="bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-4 border border-green-200">
                                            <div className="flex items-center gap-3 mb-3">
                                                <div className="p-2 rounded-lg bg-green-100">
                                                    <Star className="h-4 w-4 text-green-600" />
                                                </div>
                                                <h3 className="font-semibold text-gray-900">
                                                    Free Trial
                                                </h3>
                                            </div>
                                            <div className="space-y-2">
                                                <div className="flex justify-between items-center">
                                                    <span className="text-sm text-gray-600">
                                                        Days Left:
                                                    </span>
                                                    <span className="text-lg font-bold text-green-700">
                                                        {clinic.trial_days_left ||
                                                            0}{" "}
                                                        days
                                                    </span>
                                                </div>
                                                <div className="flex justify-between items-center">
                                                    <span className="text-sm text-gray-600">
                                                        Expires:
                                                    </span>
                                                    <span className="text-sm font-semibold text-gray-900">
                                                        {new Date(
                                                            clinic.trial_ends_at
                                                        ).toLocaleDateString()}
                                                    </span>
                                                </div>
                                                <div className="mt-3 p-2 bg-green-100 rounded-lg">
                                                    <p className="text-xs text-green-700 text-center">
                                                        üéâ Enjoy your free
                                                        trial! Upgrade anytime
                                                        to continue.
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    )}

                                {/* Subscription Information */}
                                {clinic.subscription_status === "active" &&
                                    clinic.subscription_end_date && (
                                        <div className="bg-gradient-to-r from-emerald-50 to-green-50 rounded-xl p-4 border border-emerald-200">
                                            <div className="flex items-center gap-3 mb-3">
                                                <div className="p-2 rounded-lg bg-emerald-100">
                                                    <CheckCircle className="h-4 w-4 text-emerald-600" />
                                                </div>
                                                <h3 className="font-semibold text-gray-900">
                                                    Active Subscription
                                                </h3>
                                            </div>
                                            <div className="space-y-2">
                                                <div className="flex justify-between items-center">
                                                    <span className="text-sm text-gray-600">
                                                        Days Left:
                                                    </span>
                                                    <span
                                                        className={`text-lg font-bold ${
                                                            (clinic.subscription_days_left ||
                                                                0) <= 7
                                                                ? "text-orange-700"
                                                                : "text-emerald-700"
                                                        }`}
                                                    >
                                                        {clinic.subscription_days_left ||
                                                            0}{" "}
                                                        days
                                                    </span>
                                                </div>
                                                <div className="flex justify-between items-center">
                                                    <span className="text-sm text-gray-600">
                                                        Expires:
                                                    </span>
                                                    <span className="text-sm font-semibold text-gray-900">
                                                        {new Date(
                                                            clinic.subscription_end_date
                                                        ).toLocaleDateString()}
                                                    </span>
                                                </div>
                                                {(clinic.subscription_days_left ||
                                                    0) <= 7 && (
                                                    <div className="mt-3 p-2 bg-orange-100 rounded-lg">
                                                        <p className="text-xs text-orange-700 text-center">
                                                            ‚ö†Ô∏è Your subscription
                                                            expires soon. Renew
                                                            to continue.
                                                        </p>
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    )}

                                {/* Grace Period Information */}
                                {clinic.subscription_status ===
                                    "grace_period" &&
                                    clinic.subscription_end_date && (
                                        <div className="bg-gradient-to-r from-yellow-50 to-orange-50 rounded-xl p-4 border border-yellow-200">
                                            <div className="flex items-center gap-3 mb-3">
                                                <div className="p-2 rounded-lg bg-yellow-100">
                                                    <Clock className="h-4 w-4 text-yellow-600" />
                                                </div>
                                                <h3 className="font-semibold text-gray-900">
                                                    Grace Period
                                                </h3>
                                            </div>
                                            <div className="space-y-2">
                                                <div className="flex justify-between items-center">
                                                    <span className="text-sm text-gray-600">
                                                        Days Left:
                                                    </span>
                                                    <span className="text-lg font-bold text-yellow-700">
                                                        {clinic.subscription_days_left ||
                                                            0}{" "}
                                                        days
                                                    </span>
                                                </div>
                                                <div className="flex justify-between items-center">
                                                    <span className="text-sm text-gray-600">
                                                        Ends:
                                                    </span>
                                                    <span className="text-sm font-semibold text-gray-900">
                                                        {new Date(
                                                            clinic.subscription_end_date
                                                        ).toLocaleDateString()}
                                                    </span>
                                                </div>
                                                <div className="mt-3 p-2 bg-yellow-100 rounded-lg">
                                                    <p className="text-xs text-yellow-700 text-center">
                                                        ‚è∞ Grace period active.
                                                        Renew to avoid
                                                        suspension.
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    )}

                                {/* Next Payment Information */}
                                {clinic.subscription_status === "active" &&
                                    clinic.next_payment_at && (
                                        <div className="bg-gradient-to-r from-purple-50 to-indigo-50 rounded-xl p-4 border border-purple-200">
                                            <div className="flex items-center gap-3 mb-3">
                                                <div className="p-2 rounded-lg bg-purple-100">
                                                    <DollarSign className="h-4 w-4 text-purple-600" />
                                                </div>
                                                <h3 className="font-semibold text-gray-900">
                                                    Next Payment
                                                </h3>
                                            </div>
                                            <div className="space-y-2">
                                                <div className="flex justify-between items-center">
                                                    <span className="text-sm text-gray-600">
                                                        Due Date:
                                                    </span>
                                                    <span className="text-sm font-semibold text-gray-900">
                                                        {new Date(
                                                            clinic.next_payment_at
                                                        ).toLocaleDateString()}
                                                    </span>
                                                </div>
                                                <div className="flex justify-between items-center">
                                                    <span className="text-sm text-gray-600">
                                                        Amount:
                                                    </span>
                                                    <span className="text-sm font-semibold text-gray-900">
                                                        {clinic.subscription_plan ===
                                                        "basic"
                                                            ? "‚Ç±999"
                                                            : clinic.subscription_plan ===
                                                              "premium"
                                                            ? "‚Ç±1,999"
                                                            : clinic.subscription_plan ===
                                                              "enterprise"
                                                            ? "‚Ç±2,999"
                                                            : "‚Ç±999"}
                                                    </span>
                                                </div>
                                                <div className="mt-3 p-2 bg-purple-100 rounded-lg">
                                                    <p className="text-xs text-purple-700 text-center">
                                                        üí≥ Automatic billing
                                                        will process on due
                                                        date.
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    )}
                            </div>
                        </CardContent>
                    </Card>
                </div>

                <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
                    {/* Statistics Overview */}
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <Card className="shadow-lg rounded-xl border-0 bg-white/90 backdrop-blur-sm overflow-hidden">
                            <CardHeader className="border-b-2 border-blue-200 pb-4 bg-gradient-to-r from-blue-100 to-indigo-100">
                                <div className="flex items-center gap-3">
                                    <div className="p-2.5 rounded-lg bg-gradient-to-br from-blue-500 to-indigo-600 shadow-sm">
                                        <Users className="h-5 w-5 text-white" />
                                    </div>
                                    <div>
                                        <CardTitle className="text-lg font-bold text-gray-900">
                                            Total Patients
                                        </CardTitle>
                                        <p className="text-gray-600 text-sm mt-0.5">
                                            Registered patients
                                        </p>
                                    </div>
                                </div>
                            </CardHeader>
                            <CardContent className="pt-5">
                                <div className="flex items-center justify-between">
                                    <div className="text-3xl font-bold text-gray-900">
                                        {stats.total_patients}
                                    </div>
                                    <div className="p-2 rounded-lg bg-blue-50">
                                        <TrendingUp className="h-5 w-5 text-blue-600" />
                                    </div>
                                </div>
                                <p className="text-sm text-gray-600 mt-2">
                                    Active patient records
                                </p>
                            </CardContent>
                        </Card>

                        <Card className="shadow-lg rounded-xl border-0 bg-white/90 backdrop-blur-sm overflow-hidden">
                            <CardHeader className="border-b-2 border-emerald-200 pb-4 bg-gradient-to-r from-emerald-100 to-green-100">
                                <div className="flex items-center gap-3">
                                    <div className="p-2.5 rounded-lg bg-gradient-to-br from-emerald-500 to-green-600 shadow-sm">
                                        <Calendar className="h-5 w-5 text-white" />
                                    </div>
                                    <div>
                                        <CardTitle className="text-lg font-bold text-gray-900">
                                            Today's Appointments
                                        </CardTitle>
                                        <p className="text-gray-600 text-sm mt-0.5">
                                            Scheduled for today
                                        </p>
                                    </div>
                                </div>
                            </CardHeader>
                            <CardContent className="pt-5">
                                <div className="flex items-center justify-between">
                                    <div className="text-3xl font-bold text-gray-900">
                                        {stats.today_appointments}
                                    </div>
                                    <div className="p-2 rounded-lg bg-emerald-50">
                                        <CalendarDays className="h-5 w-5 text-emerald-600" />
                                    </div>
                                </div>
                                <p className="text-sm text-gray-600 mt-2">
                                    Confirmed appointments
                                </p>
                            </CardContent>
                        </Card>

                        <Card className="shadow-lg rounded-xl border-0 bg-white/90 backdrop-blur-sm overflow-hidden">
                            <CardHeader className="border-b-2 border-purple-200 pb-4 bg-gradient-to-r from-purple-100 to-indigo-100">
                                <div className="flex items-center gap-3">
                                    <div className="p-2.5 rounded-lg bg-gradient-to-br from-purple-500 to-indigo-600 shadow-sm">
                                        <Stethoscope className="h-5 w-5 text-white" />
                                    </div>
                                    <div>
                                        <CardTitle className="text-lg font-bold text-gray-900">
                                            Today's Treatments
                                        </CardTitle>
                                        <p className="text-gray-600 text-sm mt-0.5">
                                            Completed today
                                        </p>
                                    </div>
                                </div>
                            </CardHeader>
                            <CardContent className="pt-5">
                                <div className="flex items-center justify-between">
                                    <div className="text-3xl font-bold text-gray-900">
                                        {todayTreatments.length}
                                    </div>
                                    <div className="p-2 rounded-lg bg-purple-50">
                                        <Activity className="h-5 w-5 text-purple-600" />
                                    </div>
                                </div>
                                <p className="text-sm text-gray-600 mt-2">
                                    Treatment procedures
                                </p>
                            </CardContent>
                        </Card>

                        <Card className="shadow-lg rounded-xl border-0 bg-white/90 backdrop-blur-sm overflow-hidden">
                            <CardHeader className="border-b-2 border-orange-200 pb-4 bg-gradient-to-r from-orange-100 to-red-100">
                                <div className="flex items-center gap-3">
                                    <div className="p-2.5 rounded-lg bg-gradient-to-br from-orange-500 to-red-600 shadow-sm">
                                        <Package className="h-5 w-5 text-white" />
                                    </div>
                                    <div>
                                        <CardTitle className="text-lg font-bold text-gray-900">
                                            Low Stock Items
                                        </CardTitle>
                                        <p className="text-gray-600 text-sm mt-0.5">
                                            Need restocking
                                        </p>
                                    </div>
                                </div>
                            </CardHeader>
                            <CardContent className="pt-5">
                                <div className="flex items-center justify-between">
                                    <div className="text-3xl font-bold text-gray-900">
                                        {stats.low_stock_items}
                                    </div>
                                    <div className="p-2 rounded-lg bg-orange-50">
                                        <AlertTriangle className="h-5 w-5 text-orange-600" />
                                    </div>
                                </div>
                                <p className="text-sm text-gray-600 mt-2">
                                    Items below minimum
                                </p>
                            </CardContent>
                        </Card>
                    </div>

                    {/* Main Content Grid */}
                    <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        {/* Left Column - Appointments */}
                        <div className="lg:col-span-2 space-y-6">
                            {/* Today's Appointments */}
                            <Card className="shadow-lg rounded-xl border-0 bg-white/90 backdrop-blur-sm overflow-hidden">
                                <CardHeader className="border-b-2 border-emerald-200 pb-4 bg-gradient-to-r from-emerald-100 to-green-100">
                                    <div className="flex items-center justify-between">
                                        <div className="flex items-center gap-3">
                                            <div className="p-2.5 rounded-lg bg-gradient-to-br from-emerald-500 to-green-600 shadow-sm">
                                                <Calendar className="h-5 w-5 text-white" />
                                            </div>
                                            <div>
                                                <CardTitle className="text-lg font-bold text-gray-900">
                                                    Today's Appointments
                                                </CardTitle>
                                                <p className="text-gray-600 text-sm mt-0.5">
                                                    {format(
                                                        new Date(),
                                                        "EEEE, MMMM d, yyyy"
                                                    )}
                                                </p>
                                            </div>
                                        </div>
                                        <Link
                                            href={route(
                                                "clinic.appointments.create",
                                                clinic.id
                                            )}
                                            className="inline-flex items-center gap-2 px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white font-semibold rounded-lg transition-colors duration-200 shadow-sm hover:shadow-md"
                                        >
                                            <Plus className="h-4 w-4" />
                                            Add Appointment
                                        </Link>
                                    </div>
                                </CardHeader>
                                <CardContent className="pt-5">
                                    {today_appointments.length === 0 ? (
                                        <div className="text-center py-8">
                                            <Calendar className="h-12 w-12 text-gray-400 mx-auto mb-4" />
                                            <h3 className="text-lg font-semibold text-gray-900 mb-2">
                                                No Appointments Today
                                            </h3>
                                            <p className="text-gray-600 mb-4">
                                                You have no appointments
                                                scheduled for today.
                                            </p>
                                            <Link
                                                href={route(
                                                    "clinic.appointments.create",
                                                    clinic.id
                                                )}
                                                className="inline-flex items-center gap-2 px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white font-semibold rounded-lg transition-colors duration-200"
                                            >
                                                <Plus className="h-4 w-4" />
                                                Schedule Appointment
                                            </Link>
                                        </div>
                                    ) : (
                                        <div className="space-y-3">
                                            {today_appointments.map(
                                                (appointment) => {
                                                    const StatusIcon =
                                                        getStatusIcon(
                                                            appointment.appointment_status_id
                                                        );
                                                    return (
                                                        <div
                                                            key={appointment.id}
                                                            className="flex items-center justify-between p-4 bg-gradient-to-r from-white to-gray-50/50 rounded-xl border border-gray-200 hover:shadow-md transition-all duration-200"
                                                        >
                                                            <div className="flex items-center gap-4">
                                                                <div className="p-2 rounded-lg bg-emerald-100">
                                                                    <Calendar className="h-4 w-4 text-emerald-600" />
                                                                </div>
                                                                <div>
                                                                    <h3 className="font-semibold text-gray-900">
                                                                        {
                                                                            appointment
                                                                                .patient
                                                                                .first_name
                                                                        }{" "}
                                                                        {
                                                                            appointment
                                                                                .patient
                                                                                .last_name
                                                                        }
                                                                    </h3>
                                                                    <p className="text-sm text-gray-600">
                                                                        {format(
                                                                            new Date(
                                                                                appointment.scheduled_at
                                                                            ),
                                                                            "h:mm a"
                                                                        )}{" "}
                                                                        ‚Ä¢{" "}
                                                                        {
                                                                            appointment
                                                                                .type
                                                                                .name
                                                                        }
                                                                    </p>
                                                                    <p className="text-xs text-gray-500">
                                                                        Dr.{" "}
                                                                        {appointment
                                                                            .assignedDentist
                                                                            ?.name ||
                                                                            "Unassigned"}
                                                                    </p>
                                                                </div>
                                                            </div>
                                                            <div className="flex items-center gap-3">
                                                                <Badge
                                                                    className={getStatusColor(
                                                                        appointment.appointment_status_id
                                                                    )}
                                                                >
                                                                    <StatusIcon className="h-3 w-3 mr-1" />
                                                                    {
                                                                        appointment
                                                                            .status
                                                                            .name
                                                                    }
                                                                </Badge>
                                                                <Link
                                                                    href={route(
                                                                        "clinic.appointments.show",
                                                                        [
                                                                            clinic.id,
                                                                            appointment.id,
                                                                        ]
                                                                    )}
                                                                    className="inline-flex items-center gap-1 px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg transition-colors duration-200"
                                                                >
                                                                    View
                                                                    <ArrowRight className="h-3 w-3" />
                                                                </Link>
                                                            </div>
                                                        </div>
                                                    );
                                                }
                                            )}
                                        </div>
                                    )}
                                </CardContent>
                            </Card>

                            {/* Upcoming Appointments */}
                            <Card className="shadow-lg rounded-xl border-0 bg-white/90 backdrop-blur-sm overflow-hidden">
                                <CardHeader className="border-b-2 border-blue-200 pb-4 bg-gradient-to-r from-blue-100 to-indigo-100">
                                    <div className="flex items-center justify-between">
                                        <div className="flex items-center gap-3">
                                            <div className="p-2.5 rounded-lg bg-gradient-to-br from-blue-500 to-indigo-600 shadow-sm">
                                                <CalendarDays className="h-5 w-5 text-white" />
                                            </div>
                                            <div>
                                                <CardTitle className="text-lg font-bold text-gray-900">
                                                    Upcoming Appointments
                                                </CardTitle>
                                                <p className="text-gray-600 text-sm mt-0.5">
                                                    Next 5 scheduled
                                                    appointments
                                                </p>
                                            </div>
                                        </div>
                                        <Link
                                            href={route(
                                                "clinic.appointments.index",
                                                clinic.id
                                            )}
                                            className="inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors duration-200 shadow-sm hover:shadow-md"
                                        >
                                            View All
                                            <ArrowRight className="h-4 w-4" />
                                        </Link>
                                    </div>
                                </CardHeader>
                                <CardContent className="pt-5">
                                    {upcoming_appointments.length === 0 ? (
                                        <div className="text-center py-6">
                                            <CalendarDays className="h-10 w-10 text-gray-400 mx-auto mb-3" />
                                            <p className="text-gray-600">
                                                No upcoming appointments
                                                scheduled.
                                            </p>
                                        </div>
                                    ) : (
                                        <div className="space-y-3">
                                            {upcoming_appointments.map(
                                                (appointment) => {
                                                    const StatusIcon =
                                                        getStatusIcon(
                                                            appointment.appointment_status_id
                                                        );
                                                    return (
                                                        <div
                                                            key={appointment.id}
                                                            className="flex items-center justify-between p-3 bg-gradient-to-r from-white to-blue-50/30 rounded-lg border border-blue-100 hover:shadow-sm transition-all duration-200"
                                                        >
                                                            <div className="flex items-center gap-3">
                                                                <div className="p-1.5 rounded-md bg-blue-100">
                                                                    <Calendar className="h-3 w-3 text-blue-600" />
                                                                </div>
                                                                <div>
                                                                    <h4 className="font-medium text-gray-900">
                                                                        {
                                                                            appointment
                                                                                .patient
                                                                                .first_name
                                                                        }{" "}
                                                                        {
                                                                            appointment
                                                                                .patient
                                                                                .last_name
                                                                        }
                                                                    </h4>
                                                                    <p className="text-sm text-gray-600">
                                                                        {format(
                                                                            new Date(
                                                                                appointment.scheduled_at
                                                                            ),
                                                                            "MMM d, h:mm a"
                                                                        )}{" "}
                                                                        ‚Ä¢{" "}
                                                                        {
                                                                            appointment
                                                                                .type
                                                                                .name
                                                                        }
                                                                    </p>
                                                                </div>
                                                            </div>
                                                            <div className="flex items-center gap-2">
                                                                <Badge
                                                                    className={getStatusColor(
                                                                        appointment.appointment_status_id
                                                                    )}
                                                                >
                                                                    <StatusIcon className="h-3 w-3 mr-1" />
                                                                    {
                                                                        appointment
                                                                            .status
                                                                            .name
                                                                    }
                                                                </Badge>
                                                            </div>
                                                        </div>
                                                    );
                                                }
                                            )}
                                        </div>
                                    )}
                                </CardContent>
                            </Card>
                        </div>

                        {/* Right Column - Quick Actions & Info */}
                        <div className="space-y-6">
                            {/* Quick Actions */}
                            <Card className="shadow-lg rounded-xl border-0 bg-white/90 backdrop-blur-sm overflow-hidden">
                                <CardHeader className="border-b-2 border-purple-200 pb-4 bg-gradient-to-r from-purple-100 to-indigo-100">
                                    <div className="flex items-center gap-3">
                                        <div className="p-2.5 rounded-lg bg-gradient-to-br from-purple-500 to-indigo-600 shadow-sm">
                                            <Activity className="h-5 w-5 text-white" />
                                        </div>
                                        <div>
                                            <CardTitle className="text-lg font-bold text-gray-900">
                                                Quick Actions
                                            </CardTitle>
                                            <p className="text-gray-600 text-sm mt-0.5">
                                                Common tasks
                                            </p>
                                        </div>
                                    </div>
                                </CardHeader>
                                <CardContent className="pt-5">
                                    <div className="space-y-3">
                                        <Link
                                            href={route(
                                                "clinic.patients.create",
                                                clinic.id
                                            )}
                                            className="flex items-center gap-3 p-3 bg-gradient-to-r from-emerald-50 to-green-50 rounded-lg border border-emerald-200 hover:shadow-md transition-all duration-200 group"
                                        >
                                            <div className="p-2 rounded-md bg-emerald-100 group-hover:bg-emerald-200 transition-colors">
                                                <Users className="h-4 w-4 text-emerald-600" />
                                            </div>
                                            <div className="flex-1">
                                                <h4 className="font-semibold text-gray-900">
                                                    Add New Patient
                                                </h4>
                                                <p className="text-sm text-gray-600">
                                                    Register a new patient
                                                </p>
                                            </div>
                                            <ArrowRight className="h-4 w-4 text-emerald-600" />
                                        </Link>

                                        <Link
                                            href={route(
                                                "clinic.appointments.create",
                                                clinic.id
                                            )}
                                            className="flex items-center gap-3 p-3 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200 hover:shadow-md transition-all duration-200 group"
                                        >
                                            <div className="p-2 rounded-md bg-blue-100 group-hover:bg-blue-200 transition-colors">
                                                <Calendar className="h-4 w-4 text-blue-600" />
                                            </div>
                                            <div className="flex-1">
                                                <h4 className="font-semibold text-gray-900">
                                                    Schedule Appointment
                                                </h4>
                                                <p className="text-sm text-gray-600">
                                                    Book a new appointment
                                                </p>
                                            </div>
                                            <ArrowRight className="h-4 w-4 text-blue-600" />
                                        </Link>

                                        <Link
                                            href={route(
                                                "clinic.inventory.create",
                                                clinic.id
                                            )}
                                            className="flex items-center gap-3 p-3 bg-gradient-to-r from-orange-50 to-red-50 rounded-lg border border-orange-200 hover:shadow-md transition-all duration-200 group"
                                        >
                                            <div className="p-2 rounded-md bg-orange-100 group-hover:bg-orange-200 transition-colors">
                                                <Package className="h-4 w-4 text-orange-600" />
                                            </div>
                                            <div className="flex-1">
                                                <h4 className="font-semibold text-gray-900">
                                                    Add Inventory Item
                                                </h4>
                                                <p className="text-sm text-gray-600">
                                                    Add new stock item
                                                </p>
                                            </div>
                                            <ArrowRight className="h-4 w-4 text-orange-600" />
                                        </Link>

                                        <Link
                                            href={route(
                                                "clinic.treatments.create",
                                                clinic.id
                                            )}
                                            className="flex items-center gap-3 p-3 bg-gradient-to-r from-purple-50 to-indigo-50 rounded-lg border border-purple-200 hover:shadow-md transition-all duration-200 group"
                                        >
                                            <div className="p-2 rounded-md bg-purple-100 group-hover:bg-purple-200 transition-colors">
                                                <Stethoscope className="h-4 w-4 text-purple-600" />
                                            </div>
                                            <div className="flex-1">
                                                <h4 className="font-semibold text-gray-900">
                                                    Record Treatment
                                                </h4>
                                                <p className="text-sm text-gray-600">
                                                    Log a new treatment
                                                </p>
                                            </div>
                                            <ArrowRight className="h-4 w-4 text-purple-600" />
                                        </Link>
                                    </div>
                                </CardContent>
                            </Card>

                            {/* Recent Patients */}
                            <Card className="shadow-lg rounded-xl border-0 bg-white/90 backdrop-blur-sm overflow-hidden">
                                <CardHeader className="border-b-2 border-emerald-200 pb-4 bg-gradient-to-r from-emerald-100 to-green-100">
                                    <div className="flex items-center justify-between">
                                        <div className="flex items-center gap-3">
                                            <div className="p-2.5 rounded-lg bg-gradient-to-br from-emerald-500 to-green-600 shadow-sm">
                                                <UserCheck className="h-5 w-5 text-white" />
                                            </div>
                                            <div>
                                                <CardTitle className="text-lg font-bold text-gray-900">
                                                    Recent Patients
                                                </CardTitle>
                                                <p className="text-gray-600 text-sm mt-0.5">
                                                    Latest registrations
                                                </p>
                                            </div>
                                        </div>
                                        <Link
                                            href={route(
                                                "clinic.patients.index",
                                                clinic.id
                                            )}
                                            className="inline-flex items-center gap-2 px-3 py-1.5 bg-emerald-600 hover:bg-emerald-700 text-white text-sm font-medium rounded-lg transition-colors duration-200"
                                        >
                                            View All
                                        </Link>
                                    </div>
                                </CardHeader>
                                <CardContent className="pt-5">
                                    {recent_patients.length > 0 ? (
                                        <div className="space-y-3">
                                            {recent_patients.map((patient) => (
                                                <div
                                                    key={patient.id}
                                                    className="flex items-center gap-3 p-3 bg-gradient-to-r from-white to-emerald-50/30 rounded-lg border border-emerald-100 hover:shadow-sm transition-all duration-200"
                                                >
                                                    <div className="p-1.5 rounded-md bg-emerald-100">
                                                        <Users className="h-3 w-3 text-emerald-600" />
                                                    </div>
                                                    <div className="flex-1">
                                                        <h4 className="font-medium text-gray-900">
                                                            {patient.name}
                                                        </h4>
                                                        <p className="text-sm text-gray-600">
                                                            {patient.email}
                                                        </p>
                                                    </div>
                                                    <Link
                                                        href={route(
                                                            "clinic.patients.show",
                                                            [
                                                                clinic.id,
                                                                patient.id,
                                                            ]
                                                        )}
                                                        className="text-emerald-600 hover:text-emerald-700"
                                                    >
                                                        <ArrowRight className="h-4 w-4" />
                                                    </Link>
                                                </div>
                                            ))}
                                        </div>
                                    ) : (
                                        <div className="text-center py-6">
                                            <Users className="h-10 w-10 text-gray-400 mx-auto mb-3" />
                                            <p className="text-gray-600">
                                                No recent patients.
                                            </p>
                                        </div>
                                    )}
                                </CardContent>
                            </Card>

                            {/* Low Stock Alerts */}
                            <Card className="shadow-lg rounded-xl border-0 bg-white/90 backdrop-blur-sm overflow-hidden">
                                <CardHeader className="border-b-2 border-orange-200 pb-4 bg-gradient-to-r from-orange-100 to-red-100">
                                    <div className="flex items-center justify-between">
                                        <div className="flex items-center gap-3">
                                            <div className="p-2.5 rounded-lg bg-gradient-to-br from-orange-500 to-red-600 shadow-sm">
                                                <AlertTriangle className="h-5 w-5 text-white" />
                                            </div>
                                            <div>
                                                <CardTitle className="text-lg font-bold text-gray-900">
                                                    Low Stock Alerts
                                                </CardTitle>
                                                <p className="text-gray-600 text-sm mt-0.5">
                                                    Items needing restock
                                                </p>
                                            </div>
                                        </div>
                                        <Link
                                            href={route(
                                                "clinic.inventory.index",
                                                clinic.id
                                            )}
                                            className="inline-flex items-center gap-2 px-3 py-1.5 bg-orange-600 hover:bg-orange-700 text-white text-sm font-medium rounded-lg transition-colors duration-200"
                                        >
                                            View All
                                        </Link>
                                    </div>
                                </CardHeader>
                                <CardContent className="pt-5">
                                    {lowStockItems.length > 0 ? (
                                        <div className="space-y-3">
                                            {lowStockItems
                                                .slice(0, 3)
                                                .map((item) => (
                                                    <div
                                                        key={item.id}
                                                        className="flex items-center gap-3 p-3 bg-gradient-to-r from-white to-orange-50/30 rounded-lg border border-orange-100"
                                                    >
                                                        <div className="p-1.5 rounded-md bg-orange-100">
                                                            <Package className="h-3 w-3 text-orange-600" />
                                                        </div>
                                                        <div className="flex-1">
                                                            <h4 className="font-medium text-gray-900">
                                                                {item.name}
                                                            </h4>
                                                            <p className="text-sm text-orange-600">
                                                                Quantity:{" "}
                                                                {item.quantity}{" "}
                                                                (Min:{" "}
                                                                {
                                                                    item.minimum_quantity
                                                                }
                                                                )
                                                            </p>
                                                        </div>
                                                        <Link
                                                            href={route(
                                                                "clinic.inventory.show",
                                                                [
                                                                    clinic.id,
                                                                    item.id,
                                                                ]
                                                            )}
                                                            className="text-orange-600 hover:text-orange-700"
                                                        >
                                                            <ArrowRight className="h-4 w-4" />
                                                        </Link>
                                                    </div>
                                                ))}
                                            {lowStockItems.length > 3 && (
                                                <div className="text-center pt-2">
                                                    <p className="text-sm text-gray-600">
                                                        +
                                                        {lowStockItems.length -
                                                            3}{" "}
                                                        more items
                                                    </p>
                                                </div>
                                            )}
                                        </div>
                                    ) : (
                                        <div className="text-center py-6">
                                            <PackageCheck className="h-10 w-10 text-gray-400 mx-auto mb-3" />
                                            <p className="text-gray-600">
                                                All items are well stocked.
                                            </p>
                                        </div>
                                    )}
                                </CardContent>
                            </Card>
                        </div>
                    </div>
                </div>
            </div>
        </AuthenticatedLayout>
    );
}
